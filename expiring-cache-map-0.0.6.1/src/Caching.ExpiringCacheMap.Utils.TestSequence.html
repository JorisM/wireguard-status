<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module : Caching.ExpiringCacheMap.Utils.TestSequence</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright: (c) 2014 Edward L. Blake</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License: BSD-style</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Maintainer: Edward L. Blake &lt;edwardlblake@gmail.com&gt;</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Stability: experimental</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Portability: portable</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- TestSequence monad for testing caching behaviour.</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- &gt; {-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- &gt; </span><span>
</span><span id="line-15"></span><span class="hs-comment">-- &gt; import Caching.ExpiringCacheMap.HashECM (newECMForM, lookupECM, CacheSettings(..), consistentDuration)</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- &gt; import qualified Caching.ExpiringCacheMap.Utils.TestSequence as TestSeq</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- &gt; </span><span>
</span><span id="line-18"></span><span class="hs-comment">-- &gt; import qualified Data.ByteString.Char8 as BS</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- &gt; </span><span>
</span><span id="line-20"></span><span class="hs-comment">-- &gt; test = do</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- &gt;   (TestSeq.TestSequenceState (_, events, _), return_value) &lt;- TestSeq.runTestSequence test'</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- &gt;   (putStrLn . show . reverse) events</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- &gt;   return ()</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- &gt;   where</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- &gt;     test' = do</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- &gt;       filecache &lt;- newECMForM</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- &gt;             (consistentDuration 100 -- Duration between access and expiry time of each item, no state needed.</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- &gt;               (\state _id -&gt; do number &lt;- TestSeq.readNumber</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- &gt;                                 return (state, number)))</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- &gt;             (TestSeq.getCurrentTime &gt;&gt;= return)</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- &gt;             12000 -- Time check frequency: (accumulator `mod` this_number) == 0.</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- &gt;             (CacheWithLRUList </span><span>
</span><span id="line-33"></span><span class="hs-comment">-- &gt;               6   -- Expected size of key-value map when removing elements.</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- &gt;               6   -- Size of map when to remove items from key-value map.</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- &gt;               12  -- Size of list when to compact</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- &gt;               )</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- &gt;             TestSeq.newTestSVar TestSeq.enterTestSVar TestSeq.readTestSVar</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- &gt;       </span><span>
</span><span id="line-39"></span><span class="hs-comment">-- &gt;       -- Use lookupECM whenever the contents of &quot;file1&quot; is needed.</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- &gt;       b &lt;- lookupECM filecache (&quot;file1&quot; :: BS.ByteString)</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- &gt;       TestSeq.haveNumber b</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- &gt;       b &lt;- lookupECM filecache &quot;file1&quot;</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- &gt;       b &lt;- lookupECM filecache &quot;file2&quot;</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- &gt;       TestSeq.haveNumber b</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- &gt;       return b</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-47"></span><span class="hs-comment">--</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- Evaluating the @test@ function results in a list of events.</span><span>
</span><span id="line-49"></span><span class="hs-comment">--</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- &gt;&gt;&gt; test</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- [GetVar 3,ReadNumber 4,GetTime 7,PutVar 11,HaveNumber 4,GetVar 14,PutVar 17,</span><span>
</span><span id="line-52"></span><span class="hs-comment">--  GetVar 19,ReadNumber 20,GetTime 23,PutVar 27,HaveNumber 20]</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- </span><span>
</span><span id="line-54"></span><span class="hs-comment">-- In this example the history shows 2 time accesses (@GetTime 7@ and</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- @GetTime 23@) since the time check frequency number is a high value (12000),</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- but regardless the high value a time check is still requested again because</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- of the new key request for @&quot;file2&quot;@.</span><span>
</span><span id="line-58"></span><span class="hs-comment">--</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- Changing the time frequency to 1 will alter the list of events with more</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- frequent time checks:</span><span>
</span><span id="line-61"></span><span class="hs-comment">--</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- &gt;&gt;&gt; test</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- [GetVar 3,ReadNumber 4,GetTime 7,PutVar 11,HaveNumber 4,GetVar 14,GetTime 15,</span><span>
</span><span id="line-64"></span><span class="hs-comment">--  GetTime 18,PutVar 22,GetVar 24,ReadNumber 25,GetTime 28,PutVar 32,</span><span>
</span><span id="line-65"></span><span class="hs-comment">--  HaveNumber 25]</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Caching.ExpiringCacheMap.Utils.TestSequence</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#runTestSequence"><span class="hs-identifier">runTestSequence</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#newTestSVar"><span class="hs-identifier">newTestSVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#enterTestSVar"><span class="hs-identifier">enterTestSVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#readTestSVar"><span class="hs-identifier">readTestSVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#getCurrentTime"><span class="hs-identifier">getCurrentTime</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#readNumber"><span class="hs-identifier">readNumber</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#haveNumber"><span class="hs-identifier">haveNumber</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceEvents"><span class="hs-identifier">TestSequenceEvents</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier">TestSequenceState</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier">TestSequence</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSVar"><span class="hs-identifier">TestSVar</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">

#if (!defined(__GLASGOW_HASKELL__)) || (__GLASGOW_HASKELL__ &lt; 710)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Applicative</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ap</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftM</span></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">data</span><span> </span><span id="TestSequenceEvents"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceEvents"><span class="hs-identifier hs-var">TestSequenceEvents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-89"></span><span>  </span><span id="GetVar"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#GetVar"><span class="hs-identifier hs-var">GetVar</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">|</span><span>
</span><span id="line-90"></span><span>  </span><span id="PutVar"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#PutVar"><span class="hs-identifier hs-var">PutVar</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">|</span><span>
</span><span id="line-91"></span><span>  </span><span id="GetTime"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#GetTime"><span class="hs-identifier hs-var">GetTime</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">|</span><span>
</span><span id="line-92"></span><span>  </span><span id="ReadNumber"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#ReadNumber"><span class="hs-identifier hs-var">ReadNumber</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">|</span><span>
</span><span id="line-93"></span><span>  </span><span id="HaveNumber"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#HaveNumber"><span class="hs-identifier hs-var">HaveNumber</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679053876"><span id="local-6989586621679053885"><span class="annot"><span class="annottext">TestSequenceEvents -&gt; TestSequenceEvents -&gt; Bool
(TestSequenceEvents -&gt; TestSequenceEvents -&gt; Bool)
-&gt; (TestSequenceEvents -&gt; TestSequenceEvents -&gt; Bool)
-&gt; Eq TestSequenceEvents
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: TestSequenceEvents -&gt; TestSequenceEvents -&gt; Bool
== :: TestSequenceEvents -&gt; TestSequenceEvents -&gt; Bool
$c/= :: TestSequenceEvents -&gt; TestSequenceEvents -&gt; Bool
/= :: TestSequenceEvents -&gt; TestSequenceEvents -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679053890"><span id="local-6989586621679053895"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceEvents"><span class="hs-identifier hs-type">TestSequenceEvents</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621679053905"><span class="annot"><span class="annottext">show :: TestSequenceEvents -&gt; String
</span><a href="#local-6989586621679053905"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#GetVar"><span class="hs-identifier hs-type">GetVar</span></a></span><span> </span><span id="local-6989586621679053907"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679053907"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GetVar &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679053907"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#PutVar"><span class="hs-identifier hs-type">PutVar</span></a></span><span> </span><span id="local-6989586621679053908"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679053908"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;PutVar &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679053908"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#GetTime"><span class="hs-identifier hs-type">GetTime</span></a></span><span> </span><span id="local-6989586621679053909"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679053909"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GetTime &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679053909"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#ReadNumber"><span class="hs-identifier hs-type">ReadNumber</span></a></span><span> </span><span id="local-6989586621679053910"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679053910"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ReadNumber &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679053910"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#HaveNumber"><span class="hs-identifier hs-type">HaveNumber</span></a></span><span> </span><span id="local-6989586621679053911"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679053911"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;HaveNumber &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679053911"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-keyword">newtype</span><span> </span><span id="TestSequenceState"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-var">TestSequenceState</span></a></span></span><span> </span><span id="local-6989586621679053834"><span class="annot"><a href="#local-6989586621679053834"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-105"></span><span>  </span><span id="TestSequenceState"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-var">TestSequenceState</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceEvents"><span class="hs-identifier hs-type">TestSequenceEvents</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679053834"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>  </span><span>
</span><span id="line-107"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679053784"><span id="local-6989586621679053914"><span id="local-6989586621679053919"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-type">TestSequenceState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053784"><span class="hs-identifier hs-type">ct</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679053925"><span class="annot"><span class="annottext">show :: TestSequenceState ct -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-type">TestSequenceState</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679053926"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679053926"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679053927"><span class="annot"><span class="annottext">[TestSequenceEvents]
</span><a href="#local-6989586621679053927"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe ct
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TestSequenceState &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679053926"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TestSequenceEvents] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[TestSequenceEvents]
</span><a href="#local-6989586621679053927"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-keyword">newtype</span><span> </span><span id="TestSequence"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-var">TestSequence</span></a></span></span><span> </span><span id="local-6989586621679053828"><span class="annot"><a href="#local-6989586621679053828"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679053829"><span class="annot"><a href="#local-6989586621679053829"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>  </span><span id="TestSequence"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-var">TestSequence</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-type">TestSequenceState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053828"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-type">TestSequenceState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053828"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679053829"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-keyword">newtype</span><span> </span><span id="TestSVar"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSVar"><span class="hs-identifier hs-var">TestSVar</span></a></span></span><span> </span><span id="local-6989586621679053844"><span class="annot"><a href="#local-6989586621679053844"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TestSVar"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSVar"><span class="hs-identifier hs-var">TestSVar</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679053844"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- For GHC 7.10</span><span>
</span><span id="line-117"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679053793"><span id="local-6989586621679053932"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-type">TestSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053793"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621679053938"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; TestSequence a a -&gt; TestSequence a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; TestSequence a a -&gt; TestSequence a b
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span>
</span><span id="line-119"></span><span>  </span><span>
</span><span id="line-120"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679053812"><span id="local-6989586621679053944"><span id="local-6989586621679053948"><span id="local-6989586621679053951"><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-type">TestSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053812"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621679053955"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; TestSequence a a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; TestSequence a a
forall a. a -&gt; TestSequence a a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621679053957"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b.
TestSequence a (a -&gt; b) -&gt; TestSequence a a -&gt; TestSequence a b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;*&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestSequence a (a -&gt; b) -&gt; TestSequence a a -&gt; TestSequence a b
forall (m :: * -&gt; *) a b. Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m b
</span><span class="hs-identifier hs-var">ap</span></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679053794"><span id="local-6989586621679053962"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-type">TestSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053794"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-type">TestSequence</span></a></span><span> </span><span id="local-6989586621679053966"><span class="annot"><span class="annottext">TestSequenceState a -&gt; (TestSequenceState a, a)
</span><a href="#local-6989586621679053966"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621679053967"><span class="annot"><span class="annottext">&gt;&gt;= :: forall a b.
TestSequence a a -&gt; (a -&gt; TestSequence a b) -&gt; TestSequence a b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></span></span><span> </span><span id="local-6989586621679053968"><span class="annot"><span class="annottext">a -&gt; TestSequence a b
</span><a href="#local-6989586621679053968"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><span class="annottext">(TestSequenceState a -&gt; (TestSequenceState a, b))
-&gt; TestSequence a b
forall b a.
(TestSequenceState b -&gt; (TestSequenceState b, a))
-&gt; TestSequence b a
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-var">TestSequence</span></a></span><span>
</span><span id="line-127"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679053969"><span class="annot"><span class="annottext">TestSequenceState a
</span><a href="#local-6989586621679053969"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679053970"><span class="annot"><span class="annottext">TestSequenceState a
</span><a href="#local-6989586621679053970"><span class="hs-identifier hs-var">state'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679053971"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053971"><span class="hs-identifier hs-var">ret</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestSequenceState a -&gt; (TestSequenceState a, a)
</span><a href="#local-6989586621679053966"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">TestSequenceState a
</span><a href="#local-6989586621679053969"><span class="hs-identifier hs-var">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>                     </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-type">TestSequence</span></a></span><span> </span><span id="local-6989586621679053972"><span class="annot"><span class="annottext">TestSequenceState a -&gt; (TestSequenceState a, b)
</span><a href="#local-6989586621679053972"><span class="hs-identifier hs-var">fun'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; TestSequence a b
</span><a href="#local-6989586621679053968"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053971"><span class="hs-identifier hs-var">ret</span></a></span><span>
</span><span id="line-129"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">TestSequenceState a -&gt; (TestSequenceState a, b)
</span><a href="#local-6989586621679053972"><span class="hs-identifier hs-var">fun'</span></a></span><span> </span><span class="annot"><span class="annottext">TestSequenceState a
</span><a href="#local-6989586621679053970"><span class="hs-identifier hs-var">state'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621679053976"><span class="annot"><span class="annottext">return :: forall a. a -&gt; TestSequence a a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">return</span></span></span><span> </span><span id="local-6989586621679053977"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053977"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><span class="annottext">(TestSequenceState a -&gt; (TestSequenceState a, a))
-&gt; TestSequence a a
forall b a.
(TestSequenceState b -&gt; (TestSequenceState b, a))
-&gt; TestSequence b a
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-var">TestSequence</span></a></span><span> </span><span class="annot"><span class="annottext">((TestSequenceState a -&gt; (TestSequenceState a, a))
 -&gt; TestSequence a a)
-&gt; (TestSequenceState a -&gt; (TestSequenceState a, a))
-&gt; TestSequence a a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-132"></span><span>      </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-type">TestSequenceState</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679053978"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679053978"><span class="hs-identifier hs-var">timer</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679053979"><span class="annot"><span class="annottext">[TestSequenceEvents]
</span><a href="#local-6989586621679053979"><span class="hs-identifier hs-var">hl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679053980"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679053980"><span class="hs-identifier hs-var">testsvar</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-133"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word32, [TestSequenceEvents], Maybe a) -&gt; TestSequenceState a
forall b.
(Word32, [TestSequenceEvents], Maybe b) -&gt; TestSequenceState b
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-var">TestSequenceState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679053978"><span class="hs-identifier hs-var">timer</span></a></span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[TestSequenceEvents]
</span><a href="#local-6989586621679053979"><span class="hs-identifier hs-var">hl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679053980"><span class="hs-identifier hs-var">testsvar</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053977"><span class="hs-identifier hs-var">ret</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span id="local-6989586621679053836"><span id="local-6989586621679053837"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#runTestSequence"><span class="hs-identifier hs-type">runTestSequence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679053836"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-type">TestSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053837"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053836"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-type">TestSequenceState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053837"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679053836"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-136"></span><span id="runTestSequence"><span class="annot"><span class="annottext">runTestSequence :: forall a b.
Show a =&gt;
TestSequence b a -&gt; IO (TestSequenceState b, a)
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#runTestSequence"><span class="hs-identifier hs-var hs-var">runTestSequence</span></a></span></span><span> </span><span id="local-6989586621679053985"><span class="annot"><span class="annottext">TestSequence b a
</span><a href="#local-6989586621679053985"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679053987"><span class="annot"><span class="annottext">ret :: (TestSequenceState b, a)
</span><a href="#local-6989586621679053987"><span class="hs-identifier hs-var hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestSequenceState b -&gt; (TestSequenceState b, a)
</span><a href="#local-6989586621679053988"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word32, [TestSequenceEvents], Maybe b) -&gt; TestSequenceState b
forall b.
(Word32, [TestSequenceEvents], Maybe b) -&gt; TestSequenceState b
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-var">TestSequenceState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe b
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(TestSequenceState b, a) -&gt; IO (TestSequenceState b, a)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TestSequenceState b, a)
</span><a href="#local-6989586621679053987"><span class="hs-identifier hs-var">ret</span></a></span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-type">TestSequence</span></a></span><span> </span><span id="local-6989586621679053988"><span class="annot"><span class="annottext">TestSequenceState b -&gt; (TestSequenceState b, a)
</span><a href="#local-6989586621679053988"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TestSequenceState b -&gt; (TestSequenceState b, ()))
-&gt; TestSequence b ()
forall b a.
(TestSequenceState b -&gt; (TestSequenceState b, a))
-&gt; TestSequence b a
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-var">TestSequence</span></a></span><span>
</span><span id="line-141"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-type">TestSequenceState</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679053992"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679053992"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679053993"><span class="annot"><span class="annottext">[TestSequenceEvents]
</span><a href="#local-6989586621679053993"><span class="hs-identifier hs-var">hl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679053994"><span class="annot"><span class="annottext">Maybe b
</span><a href="#local-6989586621679053994"><span class="hs-identifier hs-var">testsvar</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-142"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word32, [TestSequenceEvents], Maybe b) -&gt; TestSequenceState b
forall b.
(Word32, [TestSequenceEvents], Maybe b) -&gt; TestSequenceState b
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-var">TestSequenceState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679053992"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TestSequenceEvents]
</span><a href="#local-6989586621679053993"><span class="hs-identifier hs-var">hl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><a href="#local-6989586621679053994"><span class="hs-identifier hs-var">testsvar</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSequence b () -&gt; TestSequence b a -&gt; TestSequence b a
forall a b.
TestSequence b a -&gt; TestSequence b b -&gt; TestSequence b b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">TestSequence b a
</span><a href="#local-6989586621679053985"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span id="local-6989586621679053841"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#newTestSVar"><span class="hs-identifier hs-type">newTestSVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679053841"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-type">TestSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053841"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSVar"><span class="hs-identifier hs-type">TestSVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053841"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-145"></span><span id="newTestSVar"><span class="annot"><span class="annottext">newTestSVar :: forall a. a -&gt; TestSequence a (TestSVar a)
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#newTestSVar"><span class="hs-identifier hs-var hs-var">newTestSVar</span></a></span></span><span> </span><span id="local-6989586621679053997"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053997"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TestSequenceState a -&gt; (TestSequenceState a, TestSVar a))
-&gt; TestSequence a (TestSVar a)
forall b a.
(TestSequenceState b -&gt; (TestSequenceState b, a))
-&gt; TestSequence b a
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-var">TestSequence</span></a></span><span> </span><span class="annot"><span class="annottext">((TestSequenceState a -&gt; (TestSequenceState a, TestSVar a))
 -&gt; TestSequence a (TestSVar a))
-&gt; (TestSequenceState a -&gt; (TestSequenceState a, TestSVar a))
-&gt; TestSequence a (TestSVar a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-type">TestSequenceState</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679053998"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679053998"><span class="hs-identifier hs-var">timer</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679053999"><span class="annot"><span class="annottext">[TestSequenceEvents]
</span><a href="#local-6989586621679053999"><span class="hs-identifier hs-var">hl</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-147"></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word32, [TestSequenceEvents], Maybe a) -&gt; TestSequenceState a
forall b.
(Word32, [TestSequenceEvents], Maybe b) -&gt; TestSequenceState b
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-var">TestSequenceState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679053998"><span class="hs-identifier hs-var">timer</span></a></span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TestSequenceEvents]
</span><a href="#local-6989586621679053999"><span class="hs-identifier hs-var">hl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053997"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; TestSVar a
forall a. a -&gt; TestSVar a
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSVar"><span class="hs-identifier hs-var">TestSVar</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053997"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span id="local-6989586621679053845"><span id="local-6989586621679053846"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#enterTestSVar"><span class="hs-identifier hs-type">enterTestSVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSVar"><span class="hs-identifier hs-type">TestSVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053845"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679053845"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-type">TestSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053845"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679053845"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679053846"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-type">TestSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053845"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053846"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-150"></span><span id="enterTestSVar"><span class="annot"><span class="annottext">enterTestSVar :: forall a b.
TestSVar a -&gt; (a -&gt; TestSequence a (a, b)) -&gt; TestSequence a b
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#enterTestSVar"><span class="hs-identifier hs-var hs-var">enterTestSVar</span></a></span></span><span> </span><span id="local-6989586621679054004"><span class="annot"><span class="annottext">TestSVar a
</span><a href="#local-6989586621679054004"><span class="hs-identifier hs-var">testsvar</span></a></span></span><span> </span><span id="local-6989586621679054005"><span class="annot"><span class="annottext">a -&gt; TestSequence a (a, b)
</span><a href="#local-6989586621679054005"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679054006"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054006"><span class="hs-identifier hs-var">teststate</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestSVar a -&gt; TestSequence a a
forall a. TestSVar a -&gt; TestSequence a a
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#readTestSVar"><span class="hs-identifier hs-var">readTestSVar</span></a></span><span> </span><span class="annot"><span class="annottext">TestSVar a
</span><a href="#local-6989586621679054004"><span class="hs-identifier hs-var">testsvar</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679054007"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054007"><span class="hs-identifier hs-var">teststate'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679054008"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679054008"><span class="hs-identifier hs-var">passalong</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; TestSequence a (a, b)
</span><a href="#local-6989586621679054005"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054006"><span class="hs-identifier hs-var">teststate</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span class="annot"><span class="annottext">TestSVar a -&gt; a -&gt; TestSequence a a
forall a. TestSVar a -&gt; a -&gt; TestSequence a a
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#putTestSVar"><span class="hs-identifier hs-var">putTestSVar</span></a></span><span> </span><span class="annot"><span class="annottext">TestSVar a
</span><a href="#local-6989586621679054004"><span class="hs-identifier hs-var">testsvar</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054007"><span class="hs-identifier hs-var">teststate'</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span class="annot"><span class="annottext">b -&gt; TestSequence a b
forall a. a -&gt; TestSequence a a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679054008"><span class="hs-identifier hs-var">passalong</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- 'putTestSVar' is used along with 'readTestSVar' to implement enterTestSVar.</span><span>
</span><span id="line-157"></span><span class="hs-comment">--</span><span>
</span><span id="line-158"></span><span id="local-6989586621679053850"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#putTestSVar"><span class="hs-identifier hs-type">putTestSVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSVar"><span class="hs-identifier hs-type">TestSVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053850"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679053850"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-type">TestSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053850"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053850"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-159"></span><span id="putTestSVar"><span class="annot"><span class="annottext">putTestSVar :: forall a. TestSVar a -&gt; a -&gt; TestSequence a a
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#putTestSVar"><span class="hs-identifier hs-var hs-var">putTestSVar</span></a></span></span><span> </span><span id="local-6989586621679054012"><span class="annot"><span class="annottext">TestSVar a
</span><a href="#local-6989586621679054012"><span class="hs-identifier hs-var">_testsvar</span></a></span></span><span> </span><span id="local-6989586621679054013"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054013"><span class="hs-identifier hs-var">testsvar'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TestSequenceState a -&gt; (TestSequenceState a, a))
-&gt; TestSequence a a
forall b a.
(TestSequenceState b -&gt; (TestSequenceState b, a))
-&gt; TestSequence b a
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-var">TestSequence</span></a></span><span> </span><span class="annot"><span class="annottext">((TestSequenceState a -&gt; (TestSequenceState a, a))
 -&gt; TestSequence a a)
-&gt; (TestSequenceState a -&gt; (TestSequenceState a, a))
-&gt; TestSequence a a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-type">TestSequenceState</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054014"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">timer</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054015"><span class="annot"><span class="annottext">[TestSequenceEvents]
</span><a href="#local-6989586621679054015"><span class="hs-identifier hs-var">hl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054016"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679054016"><span class="hs-identifier hs-var">testsvar</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-161"></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word32, [TestSequenceEvents], Maybe a) -&gt; TestSequenceState a
forall b.
(Word32, [TestSequenceEvents], Maybe b) -&gt; TestSequenceState b
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-var">TestSequenceState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">timer</span></a></span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; TestSequenceEvents
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#PutVar"><span class="hs-identifier hs-var">PutVar</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">timer</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSequenceEvents -&gt; [TestSequenceEvents] -&gt; [TestSequenceEvents]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TestSequenceEvents]
</span><a href="#local-6989586621679054015"><span class="hs-identifier hs-var">hl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054013"><span class="hs-identifier hs-var">testsvar'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-162"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679054016"><span class="hs-identifier hs-var">testsvar</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054013"><span class="hs-identifier hs-var">testsvar'</span></a></span><span>
</span><span id="line-164"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054017"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054017"><span class="hs-identifier hs-var">testsvar''</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054017"><span class="hs-identifier hs-var">testsvar''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span id="local-6989586621679053849"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#readTestSVar"><span class="hs-identifier hs-type">readTestSVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSVar"><span class="hs-identifier hs-type">TestSVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053849"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-type">TestSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053849"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053849"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-167"></span><span id="readTestSVar"><span class="annot"><span class="annottext">readTestSVar :: forall a. TestSVar a -&gt; TestSequence a a
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#readTestSVar"><span class="hs-identifier hs-var hs-var">readTestSVar</span></a></span></span><span> </span><span id="local-6989586621679054020"><span class="annot"><span class="annottext">TestSVar a
</span><a href="#local-6989586621679054020"><span class="hs-identifier hs-var">_testsvar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TestSequenceState a -&gt; (TestSequenceState a, a))
-&gt; TestSequence a a
forall b a.
(TestSequenceState b -&gt; (TestSequenceState b, a))
-&gt; TestSequence b a
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-var">TestSequence</span></a></span><span> </span><span class="annot"><span class="annottext">((TestSequenceState a -&gt; (TestSequenceState a, a))
 -&gt; TestSequence a a)
-&gt; (TestSequenceState a -&gt; (TestSequenceState a, a))
-&gt; TestSequence a a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-type">TestSequenceState</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054021"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679054021"><span class="hs-identifier hs-var">timer</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054022"><span class="annot"><span class="annottext">[TestSequenceEvents]
</span><a href="#local-6989586621679054022"><span class="hs-identifier hs-var">hl</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054023"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054023"><span class="hs-identifier hs-var">testsvar</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-169"></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word32, [TestSequenceEvents], Maybe a) -&gt; TestSequenceState a
forall b.
(Word32, [TestSequenceEvents], Maybe b) -&gt; TestSequenceState b
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-var">TestSequenceState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679054021"><span class="hs-identifier hs-var">timer</span></a></span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; TestSequenceEvents
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#GetVar"><span class="hs-identifier hs-var">GetVar</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679054021"><span class="hs-identifier hs-var">timer</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSequenceEvents -&gt; [TestSequenceEvents] -&gt; [TestSequenceEvents]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TestSequenceEvents]
</span><a href="#local-6989586621679054022"><span class="hs-identifier hs-var">hl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054023"><span class="hs-identifier hs-var">testsvar</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054023"><span class="hs-identifier hs-var">testsvar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span id="local-6989586621679053853"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#getCurrentTime"><span class="hs-identifier hs-type">getCurrentTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-type">TestSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053853"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-172"></span><span id="getCurrentTime"><span class="annot"><span class="annottext">getCurrentTime :: forall a. TestSequence a Int
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#getCurrentTime"><span class="hs-identifier hs-var hs-var">getCurrentTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TestSequenceState a -&gt; (TestSequenceState a, Int))
-&gt; TestSequence a Int
forall b a.
(TestSequenceState b -&gt; (TestSequenceState b, a))
-&gt; TestSequence b a
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-var">TestSequence</span></a></span><span> </span><span class="annot"><span class="annottext">((TestSequenceState a -&gt; (TestSequenceState a, Int))
 -&gt; TestSequence a Int)
-&gt; (TestSequenceState a -&gt; (TestSequenceState a, Int))
-&gt; TestSequence a Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-type">TestSequenceState</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054030"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679054030"><span class="hs-identifier hs-var">timer</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054031"><span class="annot"><span class="annottext">[TestSequenceEvents]
</span><a href="#local-6989586621679054031"><span class="hs-identifier hs-var">hl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054032"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679054032"><span class="hs-identifier hs-var">testsvar</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-174"></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word32, [TestSequenceEvents], Maybe a) -&gt; TestSequenceState a
forall b.
(Word32, [TestSequenceEvents], Maybe b) -&gt; TestSequenceState b
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-var">TestSequenceState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679054030"><span class="hs-identifier hs-var">timer</span></a></span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; TestSequenceEvents
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#GetTime"><span class="hs-identifier hs-var">GetTime</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679054030"><span class="hs-identifier hs-var">timer</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSequenceEvents -&gt; [TestSequenceEvents] -&gt; [TestSequenceEvents]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TestSequenceEvents]
</span><a href="#local-6989586621679054031"><span class="hs-identifier hs-var">hl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679054032"><span class="hs-identifier hs-var">testsvar</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679054030"><span class="hs-identifier hs-var">timer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span id="local-6989586621679054033"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#readNumber"><span class="hs-identifier hs-type">readNumber</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-type">TestSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054033"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-177"></span><span id="readNumber"><span class="annot"><span class="annottext">readNumber :: forall a. TestSequence a Int
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#readNumber"><span class="hs-identifier hs-var hs-var">readNumber</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TestSequenceState a -&gt; (TestSequenceState a, Int))
-&gt; TestSequence a Int
forall b a.
(TestSequenceState b -&gt; (TestSequenceState b, a))
-&gt; TestSequence b a
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-var">TestSequence</span></a></span><span> </span><span class="annot"><span class="annottext">((TestSequenceState a -&gt; (TestSequenceState a, Int))
 -&gt; TestSequence a Int)
-&gt; (TestSequenceState a -&gt; (TestSequenceState a, Int))
-&gt; TestSequence a Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-type">TestSequenceState</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054036"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679054036"><span class="hs-identifier hs-var">timer</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054037"><span class="annot"><span class="annottext">[TestSequenceEvents]
</span><a href="#local-6989586621679054037"><span class="hs-identifier hs-var">hl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054038"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679054038"><span class="hs-identifier hs-var">testsvar</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679054041"><span class="annot"><span class="annottext">number :: Int
</span><a href="#local-6989586621679054041"><span class="hs-identifier hs-var hs-var">number</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679054036"><span class="hs-identifier hs-var">timer</span></a></span><span>
</span><span id="line-180"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word32, [TestSequenceEvents], Maybe a) -&gt; TestSequenceState a
forall b.
(Word32, [TestSequenceEvents], Maybe b) -&gt; TestSequenceState b
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-var">TestSequenceState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679054036"><span class="hs-identifier hs-var">timer</span></a></span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; TestSequenceEvents
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#ReadNumber"><span class="hs-identifier hs-var">ReadNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054041"><span class="hs-identifier hs-var">number</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSequenceEvents -&gt; [TestSequenceEvents] -&gt; [TestSequenceEvents]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TestSequenceEvents]
</span><a href="#local-6989586621679054037"><span class="hs-identifier hs-var">hl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679054038"><span class="hs-identifier hs-var">testsvar</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054041"><span class="hs-identifier hs-var">number</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span id="local-6989586621679053858"><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#haveNumber"><span class="hs-identifier hs-type">haveNumber</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-type">TestSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053858"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-183"></span><span id="haveNumber"><span class="annot"><span class="annottext">haveNumber :: forall a. Int -&gt; TestSequence a ()
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#haveNumber"><span class="hs-identifier hs-var hs-var">haveNumber</span></a></span></span><span> </span><span id="local-6989586621679054044"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054044"><span class="hs-identifier hs-var">number</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TestSequenceState a -&gt; (TestSequenceState a, ()))
-&gt; TestSequence a ()
forall b a.
(TestSequenceState b -&gt; (TestSequenceState b, a))
-&gt; TestSequence b a
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequence"><span class="hs-identifier hs-var">TestSequence</span></a></span><span> </span><span class="annot"><span class="annottext">((TestSequenceState a -&gt; (TestSequenceState a, ()))
 -&gt; TestSequence a ())
-&gt; (TestSequenceState a -&gt; (TestSequenceState a, ()))
-&gt; TestSequence a ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-type">TestSequenceState</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054045"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679054045"><span class="hs-identifier hs-var">timer</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054046"><span class="annot"><span class="annottext">[TestSequenceEvents]
</span><a href="#local-6989586621679054046"><span class="hs-identifier hs-var">hl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054047"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679054047"><span class="hs-identifier hs-var">testsvar</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-185"></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word32, [TestSequenceEvents], Maybe a) -&gt; TestSequenceState a
forall b.
(Word32, [TestSequenceEvents], Maybe b) -&gt; TestSequenceState b
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#TestSequenceState"><span class="hs-identifier hs-var">TestSequenceState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679054045"><span class="hs-identifier hs-var">timer</span></a></span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; TestSequenceEvents
</span><a href="Caching.ExpiringCacheMap.Utils.TestSequence.html#HaveNumber"><span class="hs-identifier hs-var">HaveNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054044"><span class="hs-identifier hs-var">number</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSequenceEvents -&gt; [TestSequenceEvents] -&gt; [TestSequenceEvents]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TestSequenceEvents]
</span><a href="#local-6989586621679054046"><span class="hs-identifier hs-var">hl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679054047"><span class="hs-identifier hs-var">testsvar</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span></pre></body></html>