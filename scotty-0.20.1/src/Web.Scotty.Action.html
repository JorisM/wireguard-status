<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE CPP               #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes        #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# language ScopedTypeVariables #-}</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Web.Scotty.Action</span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#addHeader"><span class="hs-identifier">addHeader</span></a></span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#body"><span class="hs-identifier">body</span></a></span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#bodyReader"><span class="hs-identifier">bodyReader</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#file"><span class="hs-identifier">file</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#rawResponse"><span class="hs-identifier">rawResponse</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#files"><span class="hs-identifier">files</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#finish"><span class="hs-identifier">finish</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#header"><span class="hs-identifier">header</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#headers"><span class="hs-identifier">headers</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#html"><span class="hs-identifier">html</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#liftAndCatchIO"><span class="hs-identifier">liftAndCatchIO</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#json"><span class="hs-identifier">json</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#jsonData"><span class="hs-identifier">jsonData</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#next"><span class="hs-identifier">next</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#param"><span class="hs-identifier">param</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#captureParam"><span class="hs-identifier">captureParam</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#formParam"><span class="hs-identifier">formParam</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#queryParam"><span class="hs-identifier">queryParam</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#params"><span class="hs-identifier">params</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#captureParams"><span class="hs-identifier">captureParams</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#formParams"><span class="hs-identifier">formParams</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#queryParams"><span class="hs-identifier">queryParams</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#raise"><span class="hs-identifier">raise</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#raiseStatus"><span class="hs-identifier">raiseStatus</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#throw"><span class="hs-identifier">throw</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#raw"><span class="hs-identifier">raw</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#nested"><span class="hs-identifier">nested</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#readEither"><span class="hs-identifier">readEither</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#redirect"><span class="hs-identifier">redirect</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#request"><span class="hs-identifier">request</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#rescue"><span class="hs-identifier">rescue</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#setHeader"><span class="hs-identifier">setHeader</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#status"><span class="hs-identifier">status</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#stream"><span class="hs-identifier">stream</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#text"><span class="hs-identifier">text</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Param"><span class="hs-identifier">Param</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier">Parsable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>      </span><span class="hs-comment">-- private to Scotty</span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#runAction"><span class="hs-identifier">runAction</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Blaze.ByteString.Builder</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromLazyByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadIO</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">UnliftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadUnliftIO</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadReader</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Concurrent.MVar</span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bool</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span>      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BL</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.CaseInsensitive</span></span><span>       </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CI</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>                  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ST</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">STE</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy.Encoding</span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">encodeUtf8</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Network.HTTP.Types</span></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- not re-exported until version 0.11</span><span class="hs-cpp">
#if !MIN_VERSION_http_types(0,11,0)
</span><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Network.HTTP.Types.Status</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Network.Wai</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Request</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Response</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">StreamingBody</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Application</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">requestHeaders</span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Numeric.Natural</span></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Web.Scotty.Internal.Types.html"><span class="hs-identifier">Web.Scotty.Internal.Types</span></a></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Web.Scotty.Util.html"><span class="hs-identifier">Web.Scotty.Util</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.Scotty.Util.html#mkResponse"><span class="hs-identifier">mkResponse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Util.html#addIfNotPresent"><span class="hs-identifier">addIfNotPresent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Util.html#add"><span class="hs-identifier">add</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Util.html#replace"><span class="hs-identifier">replace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Util.html#lazyTextToStrictByteString"><span class="hs-identifier">lazyTextToStrictByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Util.html#strictByteStringToLazyText"><span class="hs-identifier">strictByteStringToLazyText</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Web.Scotty.Exceptions.html"><span class="hs-identifier">Web.Scotty.Exceptions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Handler</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">catch</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Exceptions.html#catchesOptionally"><span class="hs-identifier">catchesOptionally</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">tryAny</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.Wai.Internal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ResponseReceived</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- | Evaluate a route, catch all exceptions (user-defined ones, internal and all remaining, in this order)</span><span>
</span><span id="line-88"></span><span class="hs-comment">--   and construct the 'Response'</span><span>
</span><span id="line-89"></span><span class="hs-comment">--</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- 'Nothing' indicates route failed (due to Next) and pattern matching should try the next available route.</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- 'Just' indicates a successful response.</span><span>
</span><span id="line-92"></span><span id="local-6989586621679119641"><span class="annot"><a href="Web.Scotty.Action.html#runAction"><span class="hs-identifier hs-type">runAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadUnliftIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119641"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-93"></span><span>             </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ErrorHandler"><span class="hs-identifier hs-type">ErrorHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119641"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ this handler (if present) is in charge of user-defined exceptions</span></span><span>
</span><span id="line-94"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionEnv"><span class="hs-identifier hs-type">ActionEnv</span></a></span><span>
</span><span id="line-95"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119641"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Route action to be evaluated</span></span><span>
</span><span id="line-96"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119641"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Response</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-97"></span><span id="runAction"><span class="annot"><span class="annottext">runAction :: forall (m :: * -&gt; *).
MonadUnliftIO m =&gt;
Maybe (ErrorHandler m)
-&gt; ActionEnv -&gt; ActionT m () -&gt; m (Maybe Response)
</span><a href="Web.Scotty.Action.html#runAction"><span class="hs-identifier hs-var hs-var">runAction</span></a></span></span><span> </span><span id="local-6989586621679119960"><span class="annot"><span class="annottext">Maybe (ErrorHandler m)
</span><a href="#local-6989586621679119960"><span class="hs-identifier hs-var">mh</span></a></span></span><span> </span><span id="local-6989586621679119961"><span class="annot"><span class="annottext">ActionEnv
</span><a href="#local-6989586621679119961"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621679119962"><span class="annot"><span class="annottext">ActionT m ()
</span><a href="#local-6989586621679119962"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621679119969"><span class="annot"><span class="annottext">handlers :: [ErrorHandler m]
</span><a href="#local-6989586621679119969"><span class="hs-identifier hs-var hs-var">handlers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-100"></span><span>      </span><span class="annot"><span class="annottext">ErrorHandler m
forall (m :: * -&gt; *). MonadIO m =&gt; ErrorHandler m
</span><a href="Web.Scotty.Action.html#statusErrorHandler"><span class="hs-identifier hs-var">statusErrorHandler</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- StatusError</span><span>
</span><span id="line-101"></span><span>      </span><span class="annot"><span class="annottext">ErrorHandler m
forall (m :: * -&gt; *). MonadIO m =&gt; ErrorHandler m
</span><a href="Web.Scotty.Action.html#actionErrorHandler"><span class="hs-identifier hs-var">actionErrorHandler</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ActionError i.e. Next, Finish, Redirect</span><span>
</span><span id="line-102"></span><span>      </span><span class="annot"><span class="annottext">ErrorHandler m
forall (m :: * -&gt; *). MonadIO m =&gt; ErrorHandler m
</span><a href="Web.Scotty.Action.html#someExceptionHandler"><span class="hs-identifier hs-var">someExceptionHandler</span></a></span><span> </span><span class="hs-comment">-- all remaining exceptions</span><span>
</span><span id="line-103"></span><span>               </span><span class="hs-special">]</span><span>
</span><span id="line-104"></span><span>  </span><span id="local-6989586621679119973"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679119973"><span class="hs-identifier hs-var">ok</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ReaderT ActionEnv m Bool -&gt; ActionEnv -&gt; m Bool)
-&gt; ActionEnv -&gt; ReaderT ActionEnv m Bool -&gt; m Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">ReaderT ActionEnv m Bool -&gt; ActionEnv -&gt; m Bool
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">ActionEnv
</span><a href="#local-6989586621679119961"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT ActionEnv m Bool -&gt; m Bool)
-&gt; ReaderT ActionEnv m Bool -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ActionT m Bool -&gt; ReaderT ActionEnv m Bool
forall (m :: * -&gt; *) a. ActionT m a -&gt; ReaderT ActionEnv m a
</span><a href="Web.Scotty.Internal.Types.html#runAM"><span class="hs-identifier hs-var">runAM</span></a></span><span> </span><span class="annot"><span class="annottext">(ActionT m Bool -&gt; ReaderT ActionEnv m Bool)
-&gt; ActionT m Bool -&gt; ReaderT ActionEnv m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ActionT m () -&gt; ActionT m Bool
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; m a -&gt; m Bool
</span><a href="Web.Scotty.Internal.Types.html#tryNext"><span class="hs-identifier hs-var">tryNext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionT m ()
-&gt; Maybe (ErrorHandler m) -&gt; [ErrorHandler m] -&gt; ActionT m ()
forall (m :: * -&gt; *) a.
MonadUnliftIO m =&gt;
m a -&gt; Maybe (Handler m a) -&gt; [Handler m a] -&gt; m a
</span><a href="Web.Scotty.Exceptions.html#catchesOptionally"><span class="hs-identifier hs-var">catchesOptionally</span></a></span><span> </span><span class="annot"><span class="annottext">ActionT m ()
</span><a href="#local-6989586621679119962"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ErrorHandler m)
</span><a href="#local-6989586621679119960"><span class="hs-identifier hs-var">mh</span></a></span><span> </span><span class="annot"><span class="annottext">[ErrorHandler m]
</span><a href="#local-6989586621679119969"><span class="hs-identifier hs-var">handlers</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621679119978"><span class="annot"><span class="annottext">ScottyResponse
</span><a href="#local-6989586621679119978"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ActionEnv -&gt; m ScottyResponse
forall (m :: * -&gt; *). MonadIO m =&gt; ActionEnv -&gt; m ScottyResponse
</span><a href="Web.Scotty.Internal.Types.html#getResponse"><span class="hs-identifier hs-var">getResponse</span></a></span><span> </span><span class="annot"><span class="annottext">ActionEnv
</span><a href="#local-6989586621679119961"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><span class="annottext">Maybe Response -&gt; m (Maybe Response)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Response -&gt; m (Maybe Response))
-&gt; Maybe Response -&gt; m (Maybe Response)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Response -&gt; Maybe Response -&gt; Bool -&gt; Maybe Response
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="annot"><span class="annottext">Maybe Response
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Response -&gt; Maybe Response
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Response -&gt; Maybe Response) -&gt; Response -&gt; Maybe Response
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ScottyResponse -&gt; Response
</span><a href="Web.Scotty.Util.html#mkResponse"><span class="hs-identifier hs-var">mkResponse</span></a></span><span> </span><span class="annot"><span class="annottext">ScottyResponse
</span><a href="#local-6989586621679119978"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679119973"><span class="hs-identifier hs-var">ok</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="annot"><span class="hs-comment">-- | Catches 'StatusError' and produces an appropriate HTTP response.</span></span><span>
</span><span id="line-109"></span><span id="local-6989586621679119654"><span class="annot"><a href="Web.Scotty.Action.html#statusErrorHandler"><span class="hs-identifier hs-type">statusErrorHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119654"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ErrorHandler"><span class="hs-identifier hs-type">ErrorHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119654"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-110"></span><span id="statusErrorHandler"><span class="annot"><span class="annottext">statusErrorHandler :: forall (m :: * -&gt; *). MonadIO m =&gt; ErrorHandler m
</span><a href="Web.Scotty.Action.html#statusErrorHandler"><span class="hs-identifier hs-var hs-var">statusErrorHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StatusError -&gt; ActionT m ()) -&gt; Handler (ActionT m) ()
forall (m :: * -&gt; *) a e. Exception e =&gt; (e -&gt; m a) -&gt; Handler m a
</span><span class="hs-identifier hs-var">Handler</span></span><span> </span><span class="annot"><span class="annottext">((StatusError -&gt; ActionT m ()) -&gt; Handler (ActionT m) ())
-&gt; (StatusError -&gt; ActionT m ()) -&gt; Handler (ActionT m) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#StatusError"><span class="hs-identifier hs-type">StatusError</span></a></span><span> </span><span id="local-6989586621679119996"><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679119996"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679119997"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679119997"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="annottext">Status -&gt; ActionT m ()
forall (m :: * -&gt; *). MonadIO m =&gt; Status -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#status"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679119996"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679120000"><span class="annot"><span class="annottext">code :: Text
</span><a href="#local-6989586621679120000"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; Int -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Status -&gt; Int
</span><span class="hs-identifier hs-var">statusCode</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679119996"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679120004"><span class="annot"><span class="annottext">msg :: Text
</span><a href="#local-6989586621679120004"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.fromStrict</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">STE.decodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Status -&gt; ByteString
</span><span class="hs-identifier hs-var">statusMessage</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679119996"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; ActionT m ()
forall (m :: * -&gt; *). MonadIO m =&gt; Text -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#html"><span class="hs-identifier hs-var">html</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ActionT m ()) -&gt; Text -&gt; ActionT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&lt;h1&gt;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120000"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120004"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&lt;/h1&gt;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679119997"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-comment">-- | Exception handler in charge of 'ActionError'. Rethrowing 'Next' here is caught by 'tryNext'.</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- All other cases of 'ActionError' are converted to HTTP responses.</span><span>
</span><span id="line-119"></span><span id="local-6989586621679120008"><span class="annot"><a href="Web.Scotty.Action.html#actionErrorHandler"><span class="hs-identifier hs-type">actionErrorHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679120008"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ErrorHandler"><span class="hs-identifier hs-type">ErrorHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120008"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-120"></span><span id="actionErrorHandler"><span class="annot"><span class="annottext">actionErrorHandler :: forall (m :: * -&gt; *). MonadIO m =&gt; ErrorHandler m
</span><a href="Web.Scotty.Action.html#actionErrorHandler"><span class="hs-identifier hs-var hs-var">actionErrorHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ActionError -&gt; ActionT m ()) -&gt; Handler (ActionT m) ()
forall (m :: * -&gt; *) a e. Exception e =&gt; (e -&gt; m a) -&gt; Handler m a
</span><span class="hs-identifier hs-var">Handler</span></span><span> </span><span class="annot"><span class="annottext">((ActionError -&gt; ActionT m ()) -&gt; Handler (ActionT m) ())
-&gt; (ActionError -&gt; ActionT m ()) -&gt; Handler (ActionT m) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#AERedirect"><span class="hs-identifier hs-type">AERedirect</span></a></span><span> </span><span id="local-6989586621679120020"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120020"><span class="hs-identifier hs-var">url</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><span class="annottext">Status -&gt; ActionT m ()
forall (m :: * -&gt; *). MonadIO m =&gt; Status -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#status"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status302</span></span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; ActionT m ()
forall (m :: * -&gt; *). MonadIO m =&gt; Text -&gt; Text -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#setHeader"><span class="hs-identifier hs-var">setHeader</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Location&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120020"><span class="hs-identifier hs-var">url</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><span class="annottext">ActionError
</span><a href="Web.Scotty.Internal.Types.html#AENext"><span class="hs-identifier hs-var">AENext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ActionT m ()
forall (m :: * -&gt; *) a. Monad m =&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#next"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><span class="annottext">ActionError
</span><a href="Web.Scotty.Internal.Types.html#AEFinish"><span class="hs-identifier hs-var">AEFinish</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; ActionT m ()
forall a. a -&gt; ActionT m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><span class="hs-comment">-- | Uncaught exceptions turn into HTTP 500 Server Error codes</span></span><span>
</span><span id="line-128"></span><span id="local-6989586621679120024"><span class="annot"><a href="Web.Scotty.Action.html#someExceptionHandler"><span class="hs-identifier hs-type">someExceptionHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679120024"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ErrorHandler"><span class="hs-identifier hs-type">ErrorHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120024"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-129"></span><span id="someExceptionHandler"><span class="annot"><span class="annottext">someExceptionHandler :: forall (m :: * -&gt; *). MonadIO m =&gt; ErrorHandler m
</span><a href="Web.Scotty.Action.html#someExceptionHandler"><span class="hs-identifier hs-var hs-var">someExceptionHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SomeException -&gt; ActionT m ()) -&gt; Handler (ActionT m) ()
forall (m :: * -&gt; *) a e. Exception e =&gt; (e -&gt; m a) -&gt; Handler m a
</span><span class="hs-identifier hs-var">Handler</span></span><span> </span><span class="annot"><span class="annottext">((SomeException -&gt; ActionT m ()) -&gt; Handler (ActionT m) ())
-&gt; (SomeException -&gt; ActionT m ()) -&gt; Handler (ActionT m) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">E.SomeException</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Status -&gt; ActionT m ()
forall (m :: * -&gt; *). MonadIO m =&gt; Status -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#status"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status500</span></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-comment">-- | Throw a &quot;500 Server Error&quot; 'StatusError', which can be caught with 'rescue'.</span><span>
</span><span id="line-133"></span><span class="hs-comment">--</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- Uncaught exceptions turn into HTTP 500 responses.</span><span>
</span><span id="line-135"></span><span id="local-6989586621679119699"><span id="local-6989586621679119700"><span class="annot"><a href="Web.Scotty.Action.html#raise"><span class="hs-identifier hs-type">raise</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119699"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-136"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Error text</span></span><span>
</span><span id="line-137"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119699"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119700"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-138"></span><span id="raise"><span class="annot"><span class="annottext">raise :: forall (m :: * -&gt; *) a. MonadIO m =&gt; Text -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#raise"><span class="hs-identifier hs-var hs-var">raise</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Status -&gt; Text -&gt; ActionT m a
forall (m :: * -&gt; *) a. Monad m =&gt; Status -&gt; Text -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#raiseStatus"><span class="hs-identifier hs-var">raiseStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status500</span></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- | Throw a 'StatusError' exception that has an associated HTTP error code and can be caught with 'rescue'.</span><span>
</span><span id="line-141"></span><span class="hs-comment">--</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- Uncaught exceptions turn into HTTP responses corresponding to the given status.</span><span>
</span><span id="line-143"></span><span id="local-6989586621679119703"><span id="local-6989586621679119704"><span class="annot"><a href="Web.Scotty.Action.html#raiseStatus"><span class="hs-identifier hs-type">raiseStatus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679119703"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Status</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119703"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119704"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-144"></span><span id="raiseStatus"><span class="annot"><span class="annottext">raiseStatus :: forall (m :: * -&gt; *) a. Monad m =&gt; Status -&gt; Text -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#raiseStatus"><span class="hs-identifier hs-var hs-var">raiseStatus</span></a></span></span><span> </span><span id="local-6989586621679120035"><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679120035"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StatusError -&gt; ActionT m a
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">E.throw</span></span><span> </span><span class="annot"><span class="annottext">(StatusError -&gt; ActionT m a)
-&gt; (Text -&gt; StatusError) -&gt; Text -&gt; ActionT m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Status -&gt; Text -&gt; StatusError
</span><a href="Web.Scotty.Internal.Types.html#StatusError"><span class="hs-identifier hs-var">StatusError</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679120035"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Throw an exception which can be caught within the scope of the current Action with 'rescue' or 'catch'.</span><span>
</span><span id="line-147"></span><span class="hs-comment">--</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- If the exception is not caught locally, another option is to implement a global 'Handler' (with 'defaultHandler') that defines its interpretation and a translation to HTTP error codes.</span><span>
</span><span id="line-149"></span><span class="hs-comment">--</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- Uncaught exceptions turn into HTTP 500 responses.</span><span>
</span><span id="line-151"></span><span id="local-6989586621679119713"><span id="local-6989586621679119714"><span id="local-6989586621679119715"><span class="annot"><a href="Web.Scotty.Action.html#throw"><span class="hs-identifier hs-type">throw</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119713"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">E.Exception</span></span><span> </span><span class="annot"><a href="#local-6989586621679119714"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119714"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119713"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119715"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-152"></span><span id="throw"><span class="annot"><span class="annottext">throw :: forall (m :: * -&gt; *) e a.
(MonadIO m, Exception e) =&gt;
e -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#throw"><span class="hs-identifier hs-var hs-var">throw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">e -&gt; ActionT m a
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">E.throw</span></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | Abort execution of this action and continue pattern matching routes.</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- Like an exception, any code after 'next' is not executed.</span><span>
</span><span id="line-156"></span><span class="hs-comment">--</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- NB : Internally, this is implemented with an exception that can only be</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- caught by the library, but not by the user.</span><span>
</span><span id="line-159"></span><span class="hs-comment">--</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- As an example, these two routes overlap. The only way the second one will</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- ever run is if the first one calls 'next'.</span><span>
</span><span id="line-162"></span><span class="hs-comment">--</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- &gt; get &quot;/foo/:bar&quot; $ do</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- &gt;   w :: Text &lt;- captureParam &quot;bar&quot;</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- &gt;   unless (w == &quot;special&quot;) next</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- &gt;   text &quot;You made a request to /foo/special&quot;</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- &gt; get &quot;/foo/:baz&quot; $ do</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- &gt;   w &lt;- captureParam &quot;baz&quot;</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- &gt;   text $ &quot;You made a request to: &quot; &lt;&gt; w</span><span>
</span><span id="line-171"></span><span id="local-6989586621679119695"><span id="local-6989586621679119696"><span class="annot"><a href="Web.Scotty.Action.html#next"><span class="hs-identifier hs-type">next</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679119695"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119695"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119696"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-172"></span><span id="next"><span class="annot"><span class="annottext">next :: forall (m :: * -&gt; *) a. Monad m =&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#next"><span class="hs-identifier hs-var hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ActionError -&gt; ActionT m a
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">E.throw</span></span><span> </span><span class="annot"><span class="annottext">ActionError
</span><a href="Web.Scotty.Internal.Types.html#AENext"><span class="hs-identifier hs-var">AENext</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- | Catch an exception e.g. a 'StatusError' or a user-defined exception.</span><span>
</span><span id="line-175"></span><span class="hs-comment">--</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- &gt; raise JustKidding `rescue` (\msg -&gt; text msg)</span><span>
</span><span id="line-177"></span><span id="local-6989586621679119721"><span id="local-6989586621679119722"><span id="local-6989586621679119723"><span class="annot"><a href="Web.Scotty.Action.html#rescue"><span class="hs-identifier hs-type">rescue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadUnliftIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119721"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">E.Exception</span></span><span> </span><span class="annot"><a href="#local-6989586621679119722"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119721"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119723"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119722"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119721"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119723"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119721"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119723"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-178"></span><span id="rescue"><span class="annot"><span class="annottext">rescue :: forall (m :: * -&gt; *) e a.
(MonadUnliftIO m, Exception e) =&gt;
ActionT m a -&gt; (e -&gt; ActionT m a) -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#rescue"><span class="hs-identifier hs-var hs-var">rescue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ActionT m a -&gt; (e -&gt; ActionT m a) -&gt; ActionT m a
forall (m :: * -&gt; *) e a.
(MonadUnliftIO m, Exception e) =&gt;
m a -&gt; (e -&gt; m a) -&gt; m a
</span><span class="hs-identifier hs-var">catch</span></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="annot"><span class="hs-comment">-- | Catch any synchronous IO exceptions</span></span><span>
</span><span id="line-181"></span><span id="local-6989586621679119730"><span id="local-6989586621679119731"><span class="annot"><a href="Web.Scotty.Action.html#liftAndCatchIO"><span class="hs-identifier hs-type">liftAndCatchIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119730"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119731"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119730"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119731"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-182"></span><span id="liftAndCatchIO"><span class="annot"><span class="annottext">liftAndCatchIO :: forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#liftAndCatchIO"><span class="hs-identifier hs-var hs-var">liftAndCatchIO</span></a></span></span><span> </span><span id="local-6989586621679120057"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679120057"><span class="hs-identifier hs-var">io</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; ActionT m a
forall a. IO a -&gt; ActionT m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; ActionT m a) -&gt; IO a -&gt; ActionT m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-183"></span><span>  </span><span id="local-6989586621679120059"><span class="annot"><span class="annottext">Either SomeException a
</span><a href="#local-6989586621679120059"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; IO (Either SomeException a)
forall (m :: * -&gt; *) a.
MonadUnliftIO m =&gt;
m a -&gt; m (Either SomeException a)
</span><span class="hs-identifier hs-var">tryAny</span></span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679120057"><span class="hs-identifier hs-var">io</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><span class="annottext">(SomeException -&gt; IO a)
-&gt; (a -&gt; IO a) -&gt; Either SomeException a -&gt; IO a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; IO a
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">E.throwIO</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO a
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Either SomeException a
</span><a href="#local-6989586621679120059"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- | Redirect to given URL. Like throwing an uncatchable exception. Any code after the call to redirect</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- will not be run.</span><span>
</span><span id="line-189"></span><span class="hs-comment">--</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- &gt; redirect &quot;http://www.google.com&quot;</span><span>
</span><span id="line-191"></span><span class="hs-comment">--</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- OR</span><span>
</span><span id="line-193"></span><span class="hs-comment">--</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- &gt; redirect &quot;/foo/bar&quot;</span><span>
</span><span id="line-195"></span><span id="local-6989586621679119744"><span id="local-6989586621679119745"><span class="annot"><a href="Web.Scotty.Action.html#redirect"><span class="hs-identifier hs-type">redirect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679119744"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119744"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119745"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-196"></span><span id="redirect"><span class="annot"><span class="annottext">redirect :: forall (m :: * -&gt; *) a. Monad m =&gt; Text -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#redirect"><span class="hs-identifier hs-var hs-var">redirect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ActionError -&gt; ActionT m a
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">E.throw</span></span><span> </span><span class="annot"><span class="annottext">(ActionError -&gt; ActionT m a)
-&gt; (Text -&gt; ActionError) -&gt; Text -&gt; ActionT m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ActionError
</span><a href="Web.Scotty.Internal.Types.html#AERedirect"><span class="hs-identifier hs-var">AERedirect</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">-- | Finish the execution of the current action. Like throwing an uncatchable</span><span>
</span><span id="line-199"></span><span class="hs-comment">-- exception. Any code after the call to finish will not be run.</span><span>
</span><span id="line-200"></span><span class="hs-comment">--</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- /Since: 0.10.3/</span><span>
</span><span id="line-202"></span><span id="local-6989586621679120064"><span id="local-6989586621679120065"><span class="annot"><a href="Web.Scotty.Action.html#finish"><span class="hs-identifier hs-type">finish</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679120064"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120064"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120065"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-203"></span><span id="finish"><span class="annot"><span class="annottext">finish :: forall (m :: * -&gt; *) a. Monad m =&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#finish"><span class="hs-identifier hs-var hs-var">finish</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ActionError -&gt; ActionT m a
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">E.throw</span></span><span> </span><span class="annot"><span class="annottext">ActionError
</span><a href="Web.Scotty.Internal.Types.html#AEFinish"><span class="hs-identifier hs-var">AEFinish</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="annot"><span class="hs-comment">-- | Get the 'Request' object.</span></span><span>
</span><span id="line-206"></span><span id="local-6989586621679119750"><span class="annot"><a href="Web.Scotty.Action.html#request"><span class="hs-identifier hs-type">request</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679119750"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119750"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span></span><span>
</span><span id="line-207"></span><span id="request"><span class="annot"><span class="annottext">request :: forall (m :: * -&gt; *). Monad m =&gt; ActionT m Request
</span><a href="Web.Scotty.Action.html#request"><span class="hs-identifier hs-var hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT ActionEnv m Request -&gt; ActionT m Request
forall (m :: * -&gt; *) a. ReaderT ActionEnv m a -&gt; ActionT m a
</span><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-var">ActionT</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT ActionEnv m Request -&gt; ActionT m Request)
-&gt; ReaderT ActionEnv m Request -&gt; ActionT m Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ActionEnv -&gt; Request
</span><a href="Web.Scotty.Internal.Types.html#envReq"><span class="hs-identifier hs-var">envReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ActionEnv -&gt; Request)
-&gt; ReaderT ActionEnv m ActionEnv -&gt; ReaderT ActionEnv m Request
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT ActionEnv m ActionEnv
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="annot"><span class="hs-comment">-- | Get list of uploaded files.</span></span><span>
</span><span id="line-210"></span><span id="local-6989586621679119765"><span class="annot"><a href="Web.Scotty.Action.html#files"><span class="hs-identifier hs-type">files</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679119765"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119765"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Web.Scotty.Internal.Types.html#File"><span class="hs-identifier hs-type">File</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-211"></span><span id="files"><span class="annot"><span class="annottext">files :: forall (m :: * -&gt; *). Monad m =&gt; ActionT m [File]
</span><a href="Web.Scotty.Action.html#files"><span class="hs-identifier hs-var hs-var">files</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT ActionEnv m [File] -&gt; ActionT m [File]
forall (m :: * -&gt; *) a. ReaderT ActionEnv m a -&gt; ActionT m a
</span><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-var">ActionT</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT ActionEnv m [File] -&gt; ActionT m [File])
-&gt; ReaderT ActionEnv m [File] -&gt; ActionT m [File]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ActionEnv -&gt; [File]
</span><a href="Web.Scotty.Internal.Types.html#envFiles"><span class="hs-identifier hs-var">envFiles</span></a></span><span> </span><span class="annot"><span class="annottext">(ActionEnv -&gt; [File])
-&gt; ReaderT ActionEnv m ActionEnv -&gt; ReaderT ActionEnv m [File]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT ActionEnv m ActionEnv
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="annot"><span class="hs-comment">-- | Get a request header. Header name is case-insensitive.</span></span><span>
</span><span id="line-214"></span><span id="local-6989586621679119768"><span class="annot"><a href="Web.Scotty.Action.html#header"><span class="hs-identifier hs-type">header</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679119768"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119768"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-215"></span><span id="header"><span class="annot"><span class="annottext">header :: forall (m :: * -&gt; *). Monad m =&gt; Text -&gt; ActionT m (Maybe Text)
</span><a href="Web.Scotty.Action.html#header"><span class="hs-identifier hs-var hs-var">header</span></a></span></span><span> </span><span id="local-6989586621679120101"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120101"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-216"></span><span>    </span><span id="local-6989586621679120102"><span class="annot"><span class="annottext">RequestHeaders
</span><a href="#local-6989586621679120102"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Request -&gt; RequestHeaders
</span><span class="hs-identifier hs-var">requestHeaders</span></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; RequestHeaders)
-&gt; ActionT m Request -&gt; ActionT m RequestHeaders
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ActionT m Request
forall (m :: * -&gt; *). Monad m =&gt; ActionT m Request
</span><a href="Web.Scotty.Action.html#request"><span class="hs-identifier hs-var">request</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="annottext">Maybe Text -&gt; ActionT m (Maybe Text)
forall a. a -&gt; ActionT m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; ActionT m (Maybe Text))
-&gt; Maybe Text -&gt; ActionT m (Maybe Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; Maybe ByteString -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="Web.Scotty.Util.html#strictByteStringToLazyText"><span class="hs-identifier hs-var">strictByteStringToLazyText</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; Maybe Text) -&gt; Maybe ByteString -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; RequestHeaders -&gt; Maybe ByteString
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="Web.Scotty.Util.html#lazyTextToStrictByteString"><span class="hs-identifier hs-var">lazyTextToStrictByteString</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120101"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RequestHeaders
</span><a href="#local-6989586621679120102"><span class="hs-identifier hs-var">hs</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="annot"><span class="hs-comment">-- | Get all the request headers. Header names are case-insensitive.</span></span><span>
</span><span id="line-220"></span><span id="local-6989586621679119781"><span class="annot"><a href="Web.Scotty.Action.html#headers"><span class="hs-identifier hs-type">headers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679119781"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119781"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-221"></span><span id="headers"><span class="annot"><span class="annottext">headers :: forall (m :: * -&gt; *). Monad m =&gt; ActionT m [Param]
</span><a href="Web.Scotty.Action.html#headers"><span class="hs-identifier hs-var hs-var">headers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-222"></span><span>    </span><span id="local-6989586621679120112"><span class="annot"><span class="annottext">RequestHeaders
</span><a href="#local-6989586621679120112"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Request -&gt; RequestHeaders
</span><span class="hs-identifier hs-var">requestHeaders</span></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; RequestHeaders)
-&gt; ActionT m Request -&gt; ActionT m RequestHeaders
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ActionT m Request
forall (m :: * -&gt; *). Monad m =&gt; ActionT m Request
</span><a href="Web.Scotty.Action.html#request"><span class="hs-identifier hs-var">request</span></a></span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><span class="annottext">[Param] -&gt; ActionT m [Param]
forall a. a -&gt; ActionT m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="Web.Scotty.Util.html#strictByteStringToLazyText"><span class="hs-identifier hs-var">strictByteStringToLazyText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString
forall s. CI s -&gt; s
</span><span class="hs-identifier hs-var">CI.original</span></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><a href="#local-6989586621679120114"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="Web.Scotty.Util.html#strictByteStringToLazyText"><span class="hs-identifier hs-var">strictByteStringToLazyText</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679120115"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120114"><span class="annot"><span class="annottext">CI ByteString
</span><a href="#local-6989586621679120114"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679120115"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679120115"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RequestHeaders
</span><a href="#local-6989586621679120112"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="annot"><span class="hs-comment">-- | Get the request body.</span></span><span>
</span><span id="line-228"></span><span id="local-6989586621679119784"><span class="annot"><a href="Web.Scotty.Action.html#body"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119784"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119784"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span></span><span>
</span><span id="line-229"></span><span id="body"><span class="annot"><span class="annottext">body :: forall (m :: * -&gt; *). MonadIO m =&gt; ActionT m ByteString
</span><a href="Web.Scotty.Action.html#body"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT ActionEnv m ActionEnv -&gt; ActionT m ActionEnv
forall (m :: * -&gt; *) a. ReaderT ActionEnv m a -&gt; ActionT m a
</span><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-var">ActionT</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT ActionEnv m ActionEnv
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span> </span><span class="annot"><span class="annottext">ActionT m ActionEnv
-&gt; (ActionEnv -&gt; ActionT m ByteString) -&gt; ActionT m ByteString
forall a b. ActionT m a -&gt; (a -&gt; ActionT m b) -&gt; ActionT m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO ByteString -&gt; ActionT m ByteString
forall a. IO a -&gt; ActionT m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; ActionT m ByteString)
-&gt; (ActionEnv -&gt; IO ByteString)
-&gt; ActionEnv
-&gt; ActionT m ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ActionEnv -&gt; IO ByteString
</span><a href="Web.Scotty.Internal.Types.html#envBody"><span class="hs-identifier hs-var">envBody</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- | Get an IO action that reads body chunks</span><span>
</span><span id="line-232"></span><span class="hs-comment">--</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- * This is incompatible with 'body' since 'body' consumes all chunks.</span><span>
</span><span id="line-234"></span><span id="local-6989586621679119789"><span class="annot"><a href="Web.Scotty.Action.html#bodyReader"><span class="hs-identifier hs-type">bodyReader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679119789"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119789"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-235"></span><span id="bodyReader"><span class="annot"><span class="annottext">bodyReader :: forall (m :: * -&gt; *). Monad m =&gt; ActionT m (IO ByteString)
</span><a href="Web.Scotty.Action.html#bodyReader"><span class="hs-identifier hs-var hs-var">bodyReader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT ActionEnv m (IO ByteString) -&gt; ActionT m (IO ByteString)
forall (m :: * -&gt; *) a. ReaderT ActionEnv m a -&gt; ActionT m a
</span><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-var">ActionT</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT ActionEnv m (IO ByteString) -&gt; ActionT m (IO ByteString))
-&gt; ReaderT ActionEnv m (IO ByteString) -&gt; ActionT m (IO ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ActionEnv -&gt; IO ByteString
</span><a href="Web.Scotty.Internal.Types.html#envBodyChunk"><span class="hs-identifier hs-var">envBodyChunk</span></a></span><span> </span><span class="annot"><span class="annottext">(ActionEnv -&gt; IO ByteString)
-&gt; ReaderT ActionEnv m ActionEnv
-&gt; ReaderT ActionEnv m (IO ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT ActionEnv m ActionEnv
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- | Parse the request body as a JSON object and return it.</span><span>
</span><span id="line-238"></span><span class="hs-comment">--</span><span>
</span><span id="line-239"></span><span class="hs-comment">--   If the JSON object is malformed, this sets the status to</span><span>
</span><span id="line-240"></span><span class="hs-comment">--   400 Bad Request, and throws an exception.</span><span>
</span><span id="line-241"></span><span class="hs-comment">--</span><span>
</span><span id="line-242"></span><span class="hs-comment">--   If the JSON fails to parse, this sets the status to</span><span>
</span><span id="line-243"></span><span class="hs-comment">--   422 Unprocessable Entity.</span><span>
</span><span id="line-244"></span><span class="hs-comment">--</span><span>
</span><span id="line-245"></span><span class="hs-comment">--   These status codes are as per https://www.restapitutorial.com/httpstatuscodes.html.</span><span>
</span><span id="line-246"></span><span id="local-6989586621679119791"><span id="local-6989586621679119793"><span class="annot"><a href="Web.Scotty.Action.html#jsonData"><span class="hs-identifier hs-type">jsonData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679119791"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119793"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119793"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119791"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-247"></span><span id="jsonData"><span class="annot"><span class="annottext">jsonData :: forall a (m :: * -&gt; *). (FromJSON a, MonadIO m) =&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#jsonData"><span class="hs-identifier hs-var hs-var">jsonData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-248"></span><span>    </span><span id="local-6989586621679120148"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679120148"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ActionT m ByteString
forall (m :: * -&gt; *). MonadIO m =&gt; ActionT m ByteString
</span><a href="Web.Scotty.Action.html#body"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; ActionT m () -&gt; ActionT m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679120148"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ActionT m () -&gt; ActionT m ()) -&gt; ActionT m () -&gt; ActionT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-250"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679120152"><span class="annot"><span class="annottext">htmlError :: String
</span><a href="#local-6989586621679120152"><span class="hs-identifier hs-var hs-var">htmlError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;jsonData - No data was provided.&quot;</span></span><span>
</span><span id="line-251"></span><span>      </span><span class="annot"><span class="annottext">Status -&gt; Text -&gt; ActionT m ()
forall (m :: * -&gt; *) a. Monad m =&gt; Status -&gt; Text -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#raiseStatus"><span class="hs-identifier hs-var">raiseStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status400</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ActionT m ()) -&gt; Text -&gt; ActionT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679120152"><span class="hs-identifier hs-var">htmlError</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String Value
forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><span class="hs-identifier hs-var">A.eitherDecode</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679120148"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-253"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679120155"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679120155"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-254"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679120165"><span class="annot"><span class="annottext">htmlError :: String
</span><a href="#local-6989586621679120165"><span class="hs-identifier hs-var hs-var">htmlError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;jsonData - malformed.&quot;</span></span><span>
</span><span id="line-255"></span><span>              </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; Data was: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">BL.unpack</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679120148"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-256"></span><span>              </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; Error was: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679120155"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-257"></span><span>        </span><span class="annot"><span class="annottext">Status -&gt; Text -&gt; ActionT m a
forall (m :: * -&gt; *) a. Monad m =&gt; Status -&gt; Text -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#raiseStatus"><span class="hs-identifier hs-var">raiseStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status400</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ActionT m a) -&gt; Text -&gt; ActionT m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679120165"><span class="hs-identifier hs-var">htmlError</span></a></span><span>
</span><span id="line-258"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679120167"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679120167"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Result a
forall a. FromJSON a =&gt; Value -&gt; Result a
</span><span class="hs-identifier hs-var">A.fromJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679120167"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-259"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">A.Error</span></span><span> </span><span id="local-6989586621679120170"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679120170"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-260"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679120181"><span class="annot"><span class="annottext">htmlError :: String
</span><a href="#local-6989586621679120181"><span class="hs-identifier hs-var hs-var">htmlError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;jsonData - failed parse.&quot;</span></span><span>
</span><span id="line-261"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; Data was: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">BL.unpack</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679120148"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-262"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; Error was: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679120170"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-263"></span><span>          </span><span class="annot"><span class="annottext">Status -&gt; Text -&gt; ActionT m a
forall (m :: * -&gt; *) a. Monad m =&gt; Status -&gt; Text -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#raiseStatus"><span class="hs-identifier hs-var">raiseStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status422</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ActionT m a) -&gt; Text -&gt; ActionT m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679120181"><span class="hs-identifier hs-var">htmlError</span></a></span><span>
</span><span id="line-264"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">A.Success</span></span><span> </span><span id="local-6989586621679120184"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120184"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-265"></span><span>          </span><span class="annot"><span class="annottext">a -&gt; ActionT m a
forall a. a -&gt; ActionT m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120184"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">-- | Get a parameter. First looks in captures, then form data, then query parameters.</span><span>
</span><span id="line-268"></span><span class="hs-comment">--</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- * Raises an exception which can be caught by 'rescue' if parameter is not found.</span><span>
</span><span id="line-270"></span><span class="hs-comment">--</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- * If parameter is found, but 'parseParam' fails to parse to the correct type, 'next' is called.</span><span>
</span><span id="line-272"></span><span class="hs-comment">--   This means captures are somewhat typed, in that a route won't match if a correctly typed</span><span>
</span><span id="line-273"></span><span class="hs-comment">--   capture cannot be parsed.</span><span>
</span><span id="line-274"></span><span id="local-6989586621679119807"><span id="local-6989586621679119809"><span class="annot"><a href="Web.Scotty.Action.html#param"><span class="hs-identifier hs-type">param</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119807"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119809"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119809"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119807"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-275"></span><span id="param"><span class="annot"><span class="annottext">param :: forall a (m :: * -&gt; *).
(Parsable a, MonadIO m) =&gt;
Text -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#param"><span class="hs-identifier hs-var hs-var">param</span></a></span></span><span> </span><span id="local-6989586621679120205"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120205"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679120206"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679120206"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT ActionEnv m (Maybe Text) -&gt; ActionT m (Maybe Text)
forall (m :: * -&gt; *) a. ReaderT ActionEnv m a -&gt; ActionT m a
</span><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-var">ActionT</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT ActionEnv m (Maybe Text) -&gt; ActionT m (Maybe Text))
-&gt; ReaderT ActionEnv m (Maybe Text) -&gt; ActionT m (Maybe Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Param] -&gt; Maybe Text
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120205"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">([Param] -&gt; Maybe Text)
-&gt; (ActionEnv -&gt; [Param]) -&gt; ActionEnv -&gt; Maybe Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ActionEnv -&gt; [Param]
</span><a href="Web.Scotty.Action.html#getParams"><span class="hs-identifier hs-var">getParams</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ActionEnv -&gt; Maybe Text)
-&gt; ReaderT ActionEnv m ActionEnv
-&gt; ReaderT ActionEnv m (Maybe Text)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT ActionEnv m ActionEnv
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679120206"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-278"></span><span>        </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Status -&gt; Text -&gt; ActionT m a
forall (m :: * -&gt; *) a. Monad m =&gt; Status -&gt; Text -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#raiseStatus"><span class="hs-identifier hs-var">raiseStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status500</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ActionT m a) -&gt; Text -&gt; ActionT m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Param: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120205"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; not found!&quot;</span></span><span> </span><span class="hs-comment">-- FIXME</span><span>
</span><span id="line-279"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679120208"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120208"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ActionT m a)
-&gt; (a -&gt; ActionT m a) -&gt; Either Text a -&gt; ActionT m a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionT m a -&gt; Text -&gt; ActionT m a
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">ActionT m a
forall (m :: * -&gt; *) a. Monad m =&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#next"><span class="hs-identifier hs-var">next</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; ActionT m a
forall a. a -&gt; ActionT m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Text a -&gt; ActionT m a) -&gt; Either Text a -&gt; ActionT m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text a
forall a. Parsable a =&gt; Text -&gt; Either Text a
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var">parseParam</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120208"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-280"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">param</span><span> </span><span class="hs-pragma">&quot;(#204) Not a good idea to treat all parameters identically. Use captureParam, formParam and queryParam instead. &quot;</span><span class="hs-pragma">#-}</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-comment">-- | Get a capture parameter.</span><span>
</span><span id="line-283"></span><span class="hs-comment">--</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- * Raises an exception which can be caught by 'rescue' if parameter is not found. If the exception is not caught, scotty will return a HTTP error code 500 (&quot;Internal Server Error&quot;) to the client.</span><span>
</span><span id="line-285"></span><span class="hs-comment">--</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- * If the parameter is found, but 'parseParam' fails to parse to the correct type, 'next' is called.</span><span>
</span><span id="line-287"></span><span id="local-6989586621679119816"><span id="local-6989586621679119817"><span class="annot"><a href="Web.Scotty.Action.html#captureParam"><span class="hs-identifier hs-type">captureParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119816"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679119817"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119817"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119816"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-288"></span><span id="captureParam"><span class="annot"><span class="annottext">captureParam :: forall a (m :: * -&gt; *).
(Parsable a, Monad m) =&gt;
Text -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#captureParam"><span class="hs-identifier hs-var hs-var">captureParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParamType
-&gt; (ActionEnv -&gt; [Param]) -&gt; Status -&gt; Text -&gt; ActionT m a
forall (m :: * -&gt; *) b.
(Monad m, Parsable b) =&gt;
ParamType
-&gt; (ActionEnv -&gt; [Param]) -&gt; Status -&gt; Text -&gt; ActionT m b
</span><a href="Web.Scotty.Action.html#paramWith"><span class="hs-identifier hs-var">paramWith</span></a></span><span> </span><span class="annot"><span class="annottext">ParamType
</span><a href="Web.Scotty.Action.html#CaptureParam"><span class="hs-identifier hs-var">CaptureParam</span></a></span><span> </span><span class="annot"><span class="annottext">ActionEnv -&gt; [Param]
</span><a href="Web.Scotty.Internal.Types.html#envCaptureParams"><span class="hs-identifier hs-var">envCaptureParams</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status500</span></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-comment">-- | Get a form parameter.</span><span>
</span><span id="line-291"></span><span class="hs-comment">--</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- * Raises an exception which can be caught by 'rescue' if parameter is not found. If the exception is not caught, scotty will return a HTTP error code 400 (&quot;Bad Request&quot;) to the client.</span><span>
</span><span id="line-293"></span><span class="hs-comment">--</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- * This function raises a code 400 also if the parameter is found, but 'parseParam' fails to parse to the correct type.</span><span>
</span><span id="line-295"></span><span id="local-6989586621679120217"><span id="local-6989586621679120218"><span class="annot"><a href="Web.Scotty.Action.html#formParam"><span class="hs-identifier hs-type">formParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120217"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679120218"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120218"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120217"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-296"></span><span id="formParam"><span class="annot"><span class="annottext">formParam :: forall a (m :: * -&gt; *).
(Parsable a, Monad m) =&gt;
Text -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#formParam"><span class="hs-identifier hs-var hs-var">formParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParamType
-&gt; (ActionEnv -&gt; [Param]) -&gt; Status -&gt; Text -&gt; ActionT m a
forall (m :: * -&gt; *) b.
(Monad m, Parsable b) =&gt;
ParamType
-&gt; (ActionEnv -&gt; [Param]) -&gt; Status -&gt; Text -&gt; ActionT m b
</span><a href="Web.Scotty.Action.html#paramWith"><span class="hs-identifier hs-var">paramWith</span></a></span><span> </span><span class="annot"><span class="annottext">ParamType
</span><a href="Web.Scotty.Action.html#FormParam"><span class="hs-identifier hs-var">FormParam</span></a></span><span> </span><span class="annot"><span class="annottext">ActionEnv -&gt; [Param]
</span><a href="Web.Scotty.Internal.Types.html#envFormParams"><span class="hs-identifier hs-var">envFormParams</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status400</span></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-comment">-- | Get a query parameter.</span><span>
</span><span id="line-299"></span><span class="hs-comment">--</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- * Raises an exception which can be caught by 'rescue' if parameter is not found. If the exception is not caught, scotty will return a HTTP error code 400 (&quot;Bad Request&quot;) to the client.</span><span>
</span><span id="line-301"></span><span class="hs-comment">--</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- * This function raises a code 400 also if the parameter is found, but 'parseParam' fails to parse to the correct type.</span><span>
</span><span id="line-303"></span><span id="local-6989586621679120225"><span id="local-6989586621679120226"><span class="annot"><a href="Web.Scotty.Action.html#queryParam"><span class="hs-identifier hs-type">queryParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120225"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679120226"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120226"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120225"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-304"></span><span id="queryParam"><span class="annot"><span class="annottext">queryParam :: forall a (m :: * -&gt; *).
(Parsable a, Monad m) =&gt;
Text -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#queryParam"><span class="hs-identifier hs-var hs-var">queryParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParamType
-&gt; (ActionEnv -&gt; [Param]) -&gt; Status -&gt; Text -&gt; ActionT m a
forall (m :: * -&gt; *) b.
(Monad m, Parsable b) =&gt;
ParamType
-&gt; (ActionEnv -&gt; [Param]) -&gt; Status -&gt; Text -&gt; ActionT m b
</span><a href="Web.Scotty.Action.html#paramWith"><span class="hs-identifier hs-var">paramWith</span></a></span><span> </span><span class="annot"><span class="annottext">ParamType
</span><a href="Web.Scotty.Action.html#QueryParam"><span class="hs-identifier hs-var">QueryParam</span></a></span><span> </span><span class="annot"><span class="annottext">ActionEnv -&gt; [Param]
</span><a href="Web.Scotty.Internal.Types.html#envQueryParams"><span class="hs-identifier hs-var">envQueryParams</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status400</span></span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="hs-keyword">data</span><span> </span><span id="ParamType"><span class="annot"><a href="Web.Scotty.Action.html#ParamType"><span class="hs-identifier hs-var">ParamType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CaptureParam"><span class="annot"><a href="Web.Scotty.Action.html#CaptureParam"><span class="hs-identifier hs-var">CaptureParam</span></a></span></span><span>
</span><span id="line-307"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="FormParam"><span class="annot"><a href="Web.Scotty.Action.html#FormParam"><span class="hs-identifier hs-var">FormParam</span></a></span></span><span>
</span><span id="line-308"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="QueryParam"><span class="annot"><a href="Web.Scotty.Action.html#QueryParam"><span class="hs-identifier hs-var">QueryParam</span></a></span></span><span>
</span><span id="line-309"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120234"><span id="local-6989586621679120239"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#ParamType"><span class="hs-identifier hs-type">ParamType</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-310"></span><span>  </span><span id="local-6989586621679120242"><span class="annot"><span class="annottext">show :: ParamType -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><span class="annottext">ParamType
</span><a href="Web.Scotty.Action.html#CaptureParam"><span class="hs-identifier hs-var">CaptureParam</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;capture&quot;</span></span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><span class="annottext">ParamType
</span><a href="Web.Scotty.Action.html#FormParam"><span class="hs-identifier hs-var">FormParam</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;form&quot;</span></span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><span class="annottext">ParamType
</span><a href="Web.Scotty.Action.html#QueryParam"><span class="hs-identifier hs-var">QueryParam</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;query&quot;</span></span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span id="local-6989586621679119821"><span id="local-6989586621679119822"><span class="annot"><a href="Web.Scotty.Action.html#paramWith"><span class="hs-identifier hs-type">paramWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679119821"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119822"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-316"></span><span>             </span><span class="annot"><a href="Web.Scotty.Action.html#ParamType"><span class="hs-identifier hs-type">ParamType</span></a></span><span>
</span><span id="line-317"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionEnv"><span class="hs-identifier hs-type">ActionEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Status</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ HTTP status to return if parameter is not found</span></span><span>
</span><span id="line-319"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ parameter name</span></span><span>
</span><span id="line-320"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119821"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119822"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-321"></span><span id="paramWith"><span class="annot"><span class="annottext">paramWith :: forall (m :: * -&gt; *) b.
(Monad m, Parsable b) =&gt;
ParamType
-&gt; (ActionEnv -&gt; [Param]) -&gt; Status -&gt; Text -&gt; ActionT m b
</span><a href="Web.Scotty.Action.html#paramWith"><span class="hs-identifier hs-var hs-var">paramWith</span></a></span></span><span> </span><span id="local-6989586621679120257"><span class="annot"><span class="annottext">ParamType
</span><a href="#local-6989586621679120257"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679120258"><span class="annot"><span class="annottext">ActionEnv -&gt; [Param]
</span><a href="#local-6989586621679120258"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679120259"><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679120259"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span id="local-6989586621679120260"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120260"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-322"></span><span>    </span><span id="local-6989586621679120261"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679120261"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT ActionEnv m (Maybe Text) -&gt; ActionT m (Maybe Text)
forall (m :: * -&gt; *) a. ReaderT ActionEnv m a -&gt; ActionT m a
</span><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-var">ActionT</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT ActionEnv m (Maybe Text) -&gt; ActionT m (Maybe Text))
-&gt; ReaderT ActionEnv m (Maybe Text) -&gt; ActionT m (Maybe Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Param] -&gt; Maybe Text
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120260"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">([Param] -&gt; Maybe Text)
-&gt; (ActionEnv -&gt; [Param]) -&gt; ActionEnv -&gt; Maybe Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ActionEnv -&gt; [Param]
</span><a href="#local-6989586621679120258"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ActionEnv -&gt; Maybe Text)
-&gt; ReaderT ActionEnv m ActionEnv
-&gt; ReaderT ActionEnv m (Maybe Text)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT ActionEnv m ActionEnv
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679120261"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-324"></span><span>      </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Status -&gt; Text -&gt; ActionT m b
forall (m :: * -&gt; *) a. Monad m =&gt; Status -&gt; Text -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#raiseStatus"><span class="hs-identifier hs-var">raiseStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679120259"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.unwords</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParamType -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ParamType
</span><a href="#local-6989586621679120257"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;parameter:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120260"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;not found!&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679120263"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120263"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-326"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679120272"><span class="annot"><span class="annottext">handleParseError :: ParamType -&gt; ActionT m a
</span><a href="#local-6989586621679120272"><span class="hs-identifier hs-var hs-var">handleParseError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-327"></span><span>              </span><span class="annot"><span class="annottext">ParamType
</span><a href="Web.Scotty.Action.html#CaptureParam"><span class="hs-identifier hs-var">CaptureParam</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ActionT m a
forall (m :: * -&gt; *) a. Monad m =&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#next"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-328"></span><span>              </span><span class="annot"><span class="annottext">ParamType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Status -&gt; Text -&gt; ActionT m a
forall (m :: * -&gt; *) a. Monad m =&gt; Status -&gt; Text -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#raiseStatus"><span class="hs-identifier hs-var">raiseStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679120259"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.unwords</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Cannot parse&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120263"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;as a&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParamType -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ParamType
</span><a href="#local-6989586621679120257"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;parameter&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ActionT m b)
-&gt; (b -&gt; ActionT m b) -&gt; Either Text b -&gt; ActionT m b
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionT m b -&gt; Text -&gt; ActionT m b
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(ActionT m b -&gt; Text -&gt; ActionT m b)
-&gt; ActionT m b -&gt; Text -&gt; ActionT m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ParamType -&gt; ActionT m b
forall {a}. ParamType -&gt; ActionT m a
</span><a href="#local-6989586621679120272"><span class="hs-identifier hs-var">handleParseError</span></a></span><span> </span><span class="annot"><span class="annottext">ParamType
</span><a href="#local-6989586621679120257"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b -&gt; ActionT m b
forall a. a -&gt; ActionT m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Text b -&gt; ActionT m b) -&gt; Either Text b -&gt; ActionT m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text b
forall a. Parsable a =&gt; Text -&gt; Either Text a
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var">parseParam</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120263"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="annot"><span class="hs-comment">-- | Get all parameters from capture, form and query (in that order).</span></span><span>
</span><span id="line-332"></span><span id="local-6989586621679120273"><span class="annot"><a href="Web.Scotty.Action.html#params"><span class="hs-identifier hs-type">params</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679120273"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120273"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-333"></span><span id="params"><span class="annot"><span class="annottext">params :: forall (m :: * -&gt; *). Monad m =&gt; ActionT m [Param]
</span><a href="Web.Scotty.Action.html#params"><span class="hs-identifier hs-var hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ActionEnv -&gt; [Param]) -&gt; ActionT m [Param]
forall (m :: * -&gt; *) a. Monad m =&gt; (ActionEnv -&gt; a) -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#paramsWith"><span class="hs-identifier hs-var">paramsWith</span></a></span><span> </span><span class="annot"><span class="annottext">ActionEnv -&gt; [Param]
</span><a href="Web.Scotty.Action.html#getParams"><span class="hs-identifier hs-var">getParams</span></a></span><span>
</span><span id="line-334"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">params</span><span> </span><span class="hs-pragma">&quot;(#204) Not a good idea to treat all parameters identically. Use captureParams, formParams and queryParams instead. &quot;</span><span class="hs-pragma">#-}</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="annot"><span class="hs-comment">-- | Get capture parameters</span></span><span>
</span><span id="line-337"></span><span id="local-6989586621679120277"><span class="annot"><a href="Web.Scotty.Action.html#captureParams"><span class="hs-identifier hs-type">captureParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679120277"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120277"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-338"></span><span id="captureParams"><span class="annot"><span class="annottext">captureParams :: forall (m :: * -&gt; *). Monad m =&gt; ActionT m [Param]
</span><a href="Web.Scotty.Action.html#captureParams"><span class="hs-identifier hs-var hs-var">captureParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ActionEnv -&gt; [Param]) -&gt; ActionT m [Param]
forall (m :: * -&gt; *) a. Monad m =&gt; (ActionEnv -&gt; a) -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#paramsWith"><span class="hs-identifier hs-var">paramsWith</span></a></span><span> </span><span class="annot"><span class="annottext">ActionEnv -&gt; [Param]
</span><a href="Web.Scotty.Internal.Types.html#envCaptureParams"><span class="hs-identifier hs-var">envCaptureParams</span></a></span><span>
</span><span id="line-339"></span><span class="annot"><span class="hs-comment">-- | Get form parameters</span></span><span>
</span><span id="line-340"></span><span id="local-6989586621679120280"><span class="annot"><a href="Web.Scotty.Action.html#formParams"><span class="hs-identifier hs-type">formParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679120280"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120280"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-341"></span><span id="formParams"><span class="annot"><span class="annottext">formParams :: forall (m :: * -&gt; *). Monad m =&gt; ActionT m [Param]
</span><a href="Web.Scotty.Action.html#formParams"><span class="hs-identifier hs-var hs-var">formParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ActionEnv -&gt; [Param]) -&gt; ActionT m [Param]
forall (m :: * -&gt; *) a. Monad m =&gt; (ActionEnv -&gt; a) -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#paramsWith"><span class="hs-identifier hs-var">paramsWith</span></a></span><span> </span><span class="annot"><span class="annottext">ActionEnv -&gt; [Param]
</span><a href="Web.Scotty.Internal.Types.html#envFormParams"><span class="hs-identifier hs-var">envFormParams</span></a></span><span>
</span><span id="line-342"></span><span class="annot"><span class="hs-comment">-- | Get query parameters</span></span><span>
</span><span id="line-343"></span><span id="local-6989586621679120283"><span class="annot"><a href="Web.Scotty.Action.html#queryParams"><span class="hs-identifier hs-type">queryParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679120283"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120283"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-344"></span><span id="queryParams"><span class="annot"><span class="annottext">queryParams :: forall (m :: * -&gt; *). Monad m =&gt; ActionT m [Param]
</span><a href="Web.Scotty.Action.html#queryParams"><span class="hs-identifier hs-var hs-var">queryParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ActionEnv -&gt; [Param]) -&gt; ActionT m [Param]
forall (m :: * -&gt; *) a. Monad m =&gt; (ActionEnv -&gt; a) -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#paramsWith"><span class="hs-identifier hs-var">paramsWith</span></a></span><span> </span><span class="annot"><span class="annottext">ActionEnv -&gt; [Param]
</span><a href="Web.Scotty.Internal.Types.html#envQueryParams"><span class="hs-identifier hs-var">envQueryParams</span></a></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span id="local-6989586621679119831"><span id="local-6989586621679119832"><span class="annot"><a href="Web.Scotty.Action.html#paramsWith"><span class="hs-identifier hs-type">paramsWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679119831"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionEnv"><span class="hs-identifier hs-type">ActionEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119832"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119831"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119832"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-347"></span><span id="paramsWith"><span class="annot"><span class="annottext">paramsWith :: forall (m :: * -&gt; *) a. Monad m =&gt; (ActionEnv -&gt; a) -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#paramsWith"><span class="hs-identifier hs-var hs-var">paramsWith</span></a></span></span><span> </span><span id="local-6989586621679120291"><span class="annot"><span class="annottext">ActionEnv -&gt; a
</span><a href="#local-6989586621679120291"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT ActionEnv m a -&gt; ActionT m a
forall (m :: * -&gt; *) a. ReaderT ActionEnv m a -&gt; ActionT m a
</span><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-var">ActionT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionEnv -&gt; a
</span><a href="#local-6989586621679120291"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(ActionEnv -&gt; a)
-&gt; ReaderT ActionEnv m ActionEnv -&gt; ReaderT ActionEnv m a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT ActionEnv m ActionEnv
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">getParams</span><span> </span><span class="hs-pragma">&quot;(#204) Not a good idea to treat all parameters identically&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-350"></span><span class="annot"><a href="Web.Scotty.Action.html#getParams"><span class="hs-identifier hs-type">getParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionEnv"><span class="hs-identifier hs-type">ActionEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-351"></span><span id="getParams"><span class="annot"><span class="annottext">getParams :: ActionEnv -&gt; [Param]
</span><a href="Web.Scotty.Action.html#getParams"><span class="hs-identifier hs-var hs-var">getParams</span></a></span></span><span> </span><span id="local-6989586621679120292"><span class="annot"><span class="annottext">ActionEnv
</span><a href="#local-6989586621679120292"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ActionEnv -&gt; [Param]
</span><a href="Web.Scotty.Internal.Types.html#envCaptureParams"><span class="hs-identifier hs-var">envCaptureParams</span></a></span><span> </span><span class="annot"><span class="annottext">ActionEnv
</span><a href="#local-6989586621679120292"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[Param] -&gt; [Param] -&gt; [Param]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ActionEnv -&gt; [Param]
</span><a href="Web.Scotty.Internal.Types.html#envFormParams"><span class="hs-identifier hs-var">envFormParams</span></a></span><span> </span><span class="annot"><span class="annottext">ActionEnv
</span><a href="#local-6989586621679120292"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[Param] -&gt; [Param] -&gt; [Param]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ActionEnv -&gt; [Param]
</span><a href="Web.Scotty.Internal.Types.html#envQueryParams"><span class="hs-identifier hs-var">envQueryParams</span></a></span><span> </span><span class="annot"><span class="annottext">ActionEnv
</span><a href="#local-6989586621679120292"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="annot"><span class="hs-comment">-- | Minimum implemention: 'parseParam'</span></span><span>
</span><span id="line-354"></span><span class="hs-keyword">class</span><span> </span><span id="Parsable"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-var">Parsable</span></a></span></span><span> </span><span id="local-6989586621679119815"><span class="annot"><a href="#local-6989586621679119815"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-comment">-- | Take a 'T.Text' value and parse it as 'a', or fail with a message.</span><span>
</span><span id="line-356"></span><span>    </span><span id="parseParam"><span class="annot"><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-type">parseParam</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><a href="#local-6989586621679119815"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span>    </span><span class="hs-comment">-- | Default implementation parses comma-delimited lists.</span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-comment">-- &gt; parseParamList t = mapM parseParam (T.split (== ',') t)</span><span>
</span><span id="line-361"></span><span>    </span><span id="parseParamList"><span class="annot"><a href="Web.Scotty.Action.html#parseParamList"><span class="hs-identifier hs-type">parseParamList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679119815"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-362"></span><span>    </span><span id="local-6989586621679120295"><span class="annot"><a href="Web.Scotty.Action.html#parseParamList"><span class="hs-identifier hs-var hs-var">parseParamList</span></a></span><span> </span><span id="local-6989586621679120303"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120303"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Either Text a) -&gt; [Text] -&gt; Either Text [a]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text a
forall a. Parsable a =&gt; Text -&gt; Either Text a
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var">parseParam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; [Text]
</span><span class="hs-identifier hs-var">T.split</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120303"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-comment">-- No point using 'read' for Text, ByteString, Char, and String.</span><span>
</span><span id="line-365"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120308"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120312"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text Text
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text Text
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>
</span><span id="line-366"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120315"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120318"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text Text
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text Text
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Either Text Text)
-&gt; (Text -&gt; Text) -&gt; Text -&gt; Either Text Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toStrict</span></span><span>
</span><span id="line-367"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120322"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120325"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text ByteString
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either Text ByteString
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either Text ByteString)
-&gt; (Text -&gt; ByteString) -&gt; Text -&gt; Either Text ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="Web.Scotty.Util.html#lazyTextToStrictByteString"><span class="hs-identifier hs-var">lazyTextToStrictByteString</span></a></span><span>
</span><span id="line-368"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120328"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120331"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text ByteString
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either Text ByteString
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either Text ByteString)
-&gt; (Text -&gt; ByteString) -&gt; Text -&gt; Either Text ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span>
</span><span id="line-369"></span><span class="annot"><span class="hs-comment">-- | Overrides default 'parseParamList' to parse String.</span></span><span>
</span><span id="line-370"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-371"></span><span>    </span><span id="local-6989586621679120336"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text Char
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span id="local-6989586621679120337"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120337"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120337"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-372"></span><span>                    </span><span class="hs-special">[</span><span id="local-6989586621679120339"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679120339"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Either Text Char
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679120339"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-373"></span><span>                    </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text Char
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;parseParam Char: no parse&quot;</span></span><span>
</span><span id="line-374"></span><span>    </span><span id="local-6989586621679120340"><span class="annot"><span class="annottext">parseParamList :: Text -&gt; Either Text String
</span><a href="Web.Scotty.Action.html#parseParamList"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParamList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either Text String
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either Text String)
-&gt; (Text -&gt; String) -&gt; Text -&gt; Either Text String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-comment">-- String</span><span>
</span><span id="line-375"></span><span class="hs-comment">-- | Checks if parameter is present and is null-valued, not a literal '()'.</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- If the URI requested is: '/foo?bar=()&amp;baz' then 'baz' will parse as (), where 'bar' will not.</span><span>
</span><span id="line-377"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120343"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-378"></span><span>    </span><span id="local-6989586621679120347"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text ()
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span id="local-6989586621679120348"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120348"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120348"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Either Text ()
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;parseParam Unit: no parse&quot;</span></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679119846"><span id="local-6989586621679120353"><span class="hs-special">(</span><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119846"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679119846"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120357"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text [a]
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text [a]
forall a. Parsable a =&gt; Text -&gt; Either Text [a]
</span><a href="Web.Scotty.Action.html#parseParamList"><span class="hs-identifier hs-var">parseParamList</span></a></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120360"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-383"></span><span>    </span><span id="local-6989586621679120368"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text Bool
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span id="local-6989586621679120369"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120369"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120370"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toCaseFold</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;true&quot;</span></span><span>
</span><span id="line-384"></span><span>                   </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either Text Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-385"></span><span>                   </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120370"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toCaseFold</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;false&quot;</span></span><span>
</span><span id="line-386"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either Text Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-387"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text Bool
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;parseParam Bool: no parse&quot;</span></span><span>
</span><span id="line-388"></span><span>        </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120370"><span class="annot"><span class="annottext">t' :: Text
</span><a href="#local-6989586621679120370"><span class="hs-identifier hs-var hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toCaseFold</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120369"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120374"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120379"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text Double
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text Double
forall a. Read a =&gt; Text -&gt; Either Text a
</span><a href="Web.Scotty.Action.html#readEither"><span class="hs-identifier hs-var">readEither</span></a></span><span>
</span><span id="line-391"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120382"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120387"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text Float
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text Float
forall a. Read a =&gt; Text -&gt; Either Text a
</span><a href="Web.Scotty.Action.html#readEither"><span class="hs-identifier hs-var">readEither</span></a></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120390"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120395"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text Int
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text Int
forall a. Read a =&gt; Text -&gt; Either Text a
</span><a href="Web.Scotty.Action.html#readEither"><span class="hs-identifier hs-var">readEither</span></a></span><span>
</span><span id="line-394"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120398"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int8</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120403"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text Int8
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text Int8
forall a. Read a =&gt; Text -&gt; Either Text a
</span><a href="Web.Scotty.Action.html#readEither"><span class="hs-identifier hs-var">readEither</span></a></span><span>
</span><span id="line-395"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120406"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120411"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text Int16
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text Int16
forall a. Read a =&gt; Text -&gt; Either Text a
</span><a href="Web.Scotty.Action.html#readEither"><span class="hs-identifier hs-var">readEither</span></a></span><span>
</span><span id="line-396"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120414"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120419"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text Int32
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text Int32
forall a. Read a =&gt; Text -&gt; Either Text a
</span><a href="Web.Scotty.Action.html#readEither"><span class="hs-identifier hs-var">readEither</span></a></span><span>
</span><span id="line-397"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120422"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120427"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text Int64
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text Int64
forall a. Read a =&gt; Text -&gt; Either Text a
</span><a href="Web.Scotty.Action.html#readEither"><span class="hs-identifier hs-var">readEither</span></a></span><span>
</span><span id="line-398"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120430"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120435"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text Integer
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text Integer
forall a. Read a =&gt; Text -&gt; Either Text a
</span><a href="Web.Scotty.Action.html#readEither"><span class="hs-identifier hs-var">readEither</span></a></span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120438"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120443"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text Word
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text Word
forall a. Read a =&gt; Text -&gt; Either Text a
</span><a href="Web.Scotty.Action.html#readEither"><span class="hs-identifier hs-var">readEither</span></a></span><span>
</span><span id="line-401"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120446"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120451"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text Word8
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text Word8
forall a. Read a =&gt; Text -&gt; Either Text a
</span><a href="Web.Scotty.Action.html#readEither"><span class="hs-identifier hs-var">readEither</span></a></span><span>
</span><span id="line-402"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120454"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120459"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text Word16
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text Word16
forall a. Read a =&gt; Text -&gt; Either Text a
</span><a href="Web.Scotty.Action.html#readEither"><span class="hs-identifier hs-var">readEither</span></a></span><span>
</span><span id="line-403"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120462"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120467"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text Word32
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text Word32
forall a. Read a =&gt; Text -&gt; Either Text a
</span><a href="Web.Scotty.Action.html#readEither"><span class="hs-identifier hs-var">readEither</span></a></span><span>
</span><span id="line-404"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120470"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120475"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text Word64
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text Word64
forall a. Read a =&gt; Text -&gt; Either Text a
</span><a href="Web.Scotty.Action.html#readEither"><span class="hs-identifier hs-var">readEither</span></a></span><span>
</span><span id="line-405"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120478"><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier hs-type">Parsable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120483"><span class="annot"><span class="annottext">parseParam :: Text -&gt; Either Text Natural
</span><a href="Web.Scotty.Action.html#parseParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text Natural
forall a. Read a =&gt; Text -&gt; Either Text a
</span><a href="Web.Scotty.Action.html#readEither"><span class="hs-identifier hs-var">readEither</span></a></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="hs-comment">-- | Useful for creating 'Parsable' instances for things that already implement 'Read'. Ex:</span><span>
</span><span id="line-408"></span><span class="hs-comment">--</span><span>
</span><span id="line-409"></span><span class="hs-comment">-- &gt; instance Parsable Int where parseParam = readEither</span><span>
</span><span id="line-410"></span><span id="local-6989586621679119847"><span class="annot"><a href="Web.Scotty.Action.html#readEither"><span class="hs-identifier hs-type">readEither</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679119847"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><a href="#local-6989586621679119847"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-411"></span><span id="readEither"><span class="annot"><span class="annottext">readEither :: forall a. Read a =&gt; Text -&gt; Either Text a
</span><a href="Web.Scotty.Action.html#readEither"><span class="hs-identifier hs-var hs-var">readEither</span></a></span></span><span> </span><span id="local-6989586621679120493"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120493"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120494"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120494"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120494"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadS a
forall a. Read a =&gt; ReadS a
</span><span class="hs-identifier hs-var">reads</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120493"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-412"></span><span>                </span><span class="hs-special">[</span><span id="local-6989586621679120496"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120496"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either Text a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120496"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-413"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;readEither: no parse&quot;</span></span><span>
</span><span id="line-414"></span><span>                </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;readEither: ambiguous parse&quot;</span></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="annot"><span class="hs-comment">-- | Set the HTTP response status.</span></span><span>
</span><span id="line-417"></span><span id="local-6989586621679119686"><span class="annot"><a href="Web.Scotty.Action.html#status"><span class="hs-identifier hs-type">status</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119686"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Status</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119686"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-418"></span><span id="status"><span class="annot"><span class="annottext">status :: forall (m :: * -&gt; *). MonadIO m =&gt; Status -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#status"><span class="hs-identifier hs-var hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ScottyResponse -&gt; ScottyResponse) -&gt; ActionT m ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
(ScottyResponse -&gt; ScottyResponse) -&gt; ActionT m ()
</span><a href="Web.Scotty.Internal.Types.html#modifyResponse"><span class="hs-identifier hs-var">modifyResponse</span></a></span><span> </span><span class="annot"><span class="annottext">((ScottyResponse -&gt; ScottyResponse) -&gt; ActionT m ())
-&gt; (Status -&gt; ScottyResponse -&gt; ScottyResponse)
-&gt; Status
-&gt; ActionT m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Status -&gt; ScottyResponse -&gt; ScottyResponse
</span><a href="Web.Scotty.Internal.Types.html#setStatus"><span class="hs-identifier hs-var">setStatus</span></a></span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="hs-comment">-- Not exported, but useful in the functions below.</span><span>
</span><span id="line-421"></span><span id="local-6989586621679119854"><span class="annot"><a href="Web.Scotty.Action.html#changeHeader"><span class="hs-identifier hs-type">changeHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119854"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-422"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CI.CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HeaderName</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HeaderName</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119854"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-424"></span><span id="changeHeader"><span class="annot"><span class="annottext">changeHeader :: forall (m :: * -&gt; *).
MonadIO m =&gt;
(CI ByteString -&gt; ByteString -&gt; RequestHeaders -&gt; RequestHeaders)
-&gt; Text -&gt; Text -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#changeHeader"><span class="hs-identifier hs-var hs-var">changeHeader</span></a></span></span><span> </span><span id="local-6989586621679120506"><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString -&gt; RequestHeaders -&gt; RequestHeaders
</span><a href="#local-6989586621679120506"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679120507"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120507"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-425"></span><span>  </span><span class="annot"><span class="annottext">(ScottyResponse -&gt; ScottyResponse) -&gt; ActionT m ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
(ScottyResponse -&gt; ScottyResponse) -&gt; ActionT m ()
</span><a href="Web.Scotty.Internal.Types.html#modifyResponse"><span class="hs-identifier hs-var">modifyResponse</span></a></span><span> </span><span class="annot"><span class="annottext">((ScottyResponse -&gt; ScottyResponse) -&gt; ActionT m ())
-&gt; (Text -&gt; ScottyResponse -&gt; ScottyResponse)
-&gt; Text
-&gt; ActionT m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(RequestHeaders -&gt; RequestHeaders)
-&gt; ScottyResponse -&gt; ScottyResponse
</span><a href="Web.Scotty.Internal.Types.html#setHeaderWith"><span class="hs-identifier hs-var">setHeaderWith</span></a></span><span> </span><span class="annot"><span class="annottext">((RequestHeaders -&gt; RequestHeaders)
 -&gt; ScottyResponse -&gt; ScottyResponse)
-&gt; (Text -&gt; RequestHeaders -&gt; RequestHeaders)
-&gt; Text
-&gt; ScottyResponse
-&gt; ScottyResponse
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString -&gt; RequestHeaders -&gt; RequestHeaders
</span><a href="#local-6989586621679120506"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; CI ByteString) -&gt; ByteString -&gt; CI ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="Web.Scotty.Util.html#lazyTextToStrictByteString"><span class="hs-identifier hs-var">lazyTextToStrictByteString</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120507"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; RequestHeaders -&gt; RequestHeaders)
-&gt; (Text -&gt; ByteString) -&gt; Text -&gt; RequestHeaders -&gt; RequestHeaders
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="Web.Scotty.Util.html#lazyTextToStrictByteString"><span class="hs-identifier hs-var">lazyTextToStrictByteString</span></a></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="annot"><span class="hs-comment">-- | Add to the response headers. Header names are case-insensitive.</span></span><span>
</span><span id="line-428"></span><span id="local-6989586621679120509"><span class="annot"><a href="Web.Scotty.Action.html#addHeader"><span class="hs-identifier hs-type">addHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679120509"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120509"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-429"></span><span id="addHeader"><span class="annot"><span class="annottext">addHeader :: forall (m :: * -&gt; *). MonadIO m =&gt; Text -&gt; Text -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#addHeader"><span class="hs-identifier hs-var hs-var">addHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CI ByteString -&gt; ByteString -&gt; RequestHeaders -&gt; RequestHeaders)
-&gt; Text -&gt; Text -&gt; ActionT m ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
(CI ByteString -&gt; ByteString -&gt; RequestHeaders -&gt; RequestHeaders)
-&gt; Text -&gt; Text -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#changeHeader"><span class="hs-identifier hs-var">changeHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString -&gt; RequestHeaders -&gt; RequestHeaders
forall a b. a -&gt; b -&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="Web.Scotty.Util.html#add"><span class="hs-identifier hs-var">add</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="hs-comment">-- | Set one of the response headers. Will override any previously set value for that header.</span><span>
</span><span id="line-432"></span><span class="hs-comment">-- Header names are case-insensitive.</span><span>
</span><span id="line-433"></span><span id="local-6989586621679119694"><span class="annot"><a href="Web.Scotty.Action.html#setHeader"><span class="hs-identifier hs-type">setHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119694"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119694"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-434"></span><span id="setHeader"><span class="annot"><span class="annottext">setHeader :: forall (m :: * -&gt; *). MonadIO m =&gt; Text -&gt; Text -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#setHeader"><span class="hs-identifier hs-var hs-var">setHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CI ByteString -&gt; ByteString -&gt; RequestHeaders -&gt; RequestHeaders)
-&gt; Text -&gt; Text -&gt; ActionT m ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
(CI ByteString -&gt; ByteString -&gt; RequestHeaders -&gt; RequestHeaders)
-&gt; Text -&gt; Text -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#changeHeader"><span class="hs-identifier hs-var">changeHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString -&gt; RequestHeaders -&gt; RequestHeaders
forall a b. Eq a =&gt; a -&gt; b -&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="Web.Scotty.Util.html#replace"><span class="hs-identifier hs-var">replace</span></a></span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span class="hs-comment">-- | Set the body of the response to the given 'T.Text' value. Also sets \&quot;Content-Type\&quot;</span><span>
</span><span id="line-437"></span><span class="hs-comment">-- header to \&quot;text/plain; charset=utf-8\&quot; if it has not already been set.</span><span>
</span><span id="line-438"></span><span id="local-6989586621679120516"><span class="annot"><a href="Web.Scotty.Action.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679120516"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120516"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-439"></span><span id="text"><span class="annot"><span class="annottext">text :: forall (m :: * -&gt; *). MonadIO m =&gt; Text -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#text"><span class="hs-identifier hs-var hs-var">text</span></a></span></span><span> </span><span id="local-6989586621679120526"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120526"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-440"></span><span>    </span><span class="annot"><span class="annottext">(CI ByteString -&gt; ByteString -&gt; RequestHeaders -&gt; RequestHeaders)
-&gt; Text -&gt; Text -&gt; ActionT m ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
(CI ByteString -&gt; ByteString -&gt; RequestHeaders -&gt; RequestHeaders)
-&gt; Text -&gt; Text -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#changeHeader"><span class="hs-identifier hs-var">changeHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString -&gt; RequestHeaders -&gt; RequestHeaders
forall a b. Eq a =&gt; a -&gt; b -&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="Web.Scotty.Util.html#addIfNotPresent"><span class="hs-identifier hs-var">addIfNotPresent</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Content-Type&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;text/plain; charset=utf-8&quot;</span></span><span>
</span><span id="line-441"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; ActionT m ()
forall (m :: * -&gt; *). MonadIO m =&gt; ByteString -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#raw"><span class="hs-identifier hs-var">raw</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ActionT m ()) -&gt; ByteString -&gt; ActionT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120526"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="hs-comment">-- | Set the body of the response to the given 'T.Text' value. Also sets \&quot;Content-Type\&quot;</span><span>
</span><span id="line-444"></span><span class="hs-comment">-- header to \&quot;text/html; charset=utf-8\&quot; if it has not already been set.</span><span>
</span><span id="line-445"></span><span id="local-6989586621679119690"><span class="annot"><a href="Web.Scotty.Action.html#html"><span class="hs-identifier hs-type">html</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119690"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119690"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-446"></span><span id="html"><span class="annot"><span class="annottext">html :: forall (m :: * -&gt; *). MonadIO m =&gt; Text -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#html"><span class="hs-identifier hs-var hs-var">html</span></a></span></span><span> </span><span id="local-6989586621679120536"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120536"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-447"></span><span>    </span><span class="annot"><span class="annottext">(CI ByteString -&gt; ByteString -&gt; RequestHeaders -&gt; RequestHeaders)
-&gt; Text -&gt; Text -&gt; ActionT m ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
(CI ByteString -&gt; ByteString -&gt; RequestHeaders -&gt; RequestHeaders)
-&gt; Text -&gt; Text -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#changeHeader"><span class="hs-identifier hs-var">changeHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString -&gt; RequestHeaders -&gt; RequestHeaders
forall a b. Eq a =&gt; a -&gt; b -&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="Web.Scotty.Util.html#addIfNotPresent"><span class="hs-identifier hs-var">addIfNotPresent</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Content-Type&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;text/html; charset=utf-8&quot;</span></span><span>
</span><span id="line-448"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; ActionT m ()
forall (m :: * -&gt; *). MonadIO m =&gt; ByteString -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#raw"><span class="hs-identifier hs-var">raw</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ActionT m ()) -&gt; ByteString -&gt; ActionT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679120536"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span class="hs-comment">-- | Send a file as the response. Doesn't set the \&quot;Content-Type\&quot; header, so you probably</span><span>
</span><span id="line-451"></span><span class="hs-comment">-- want to do that on your own with 'setHeader'. Setting a status code will have no effect</span><span>
</span><span id="line-452"></span><span class="hs-comment">-- because Warp will overwrite that to 200 (see 'Network.Wai.Handler.Warp.Internal.sendResponse').</span><span>
</span><span id="line-453"></span><span id="local-6989586621679119865"><span class="annot"><a href="Web.Scotty.Action.html#file"><span class="hs-identifier hs-type">file</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119865"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119865"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-454"></span><span id="file"><span class="annot"><span class="annottext">file :: forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#file"><span class="hs-identifier hs-var hs-var">file</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ScottyResponse -&gt; ScottyResponse) -&gt; ActionT m ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
(ScottyResponse -&gt; ScottyResponse) -&gt; ActionT m ()
</span><a href="Web.Scotty.Internal.Types.html#modifyResponse"><span class="hs-identifier hs-var">modifyResponse</span></a></span><span> </span><span class="annot"><span class="annottext">((ScottyResponse -&gt; ScottyResponse) -&gt; ActionT m ())
-&gt; (String -&gt; ScottyResponse -&gt; ScottyResponse)
-&gt; String
-&gt; ActionT m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; ScottyResponse -&gt; ScottyResponse
</span><a href="Web.Scotty.Internal.Types.html#setContent"><span class="hs-identifier hs-var">setContent</span></a></span><span> </span><span class="annot"><span class="annottext">(Content -&gt; ScottyResponse -&gt; ScottyResponse)
-&gt; (String -&gt; Content)
-&gt; String
-&gt; ScottyResponse
-&gt; ScottyResponse
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Content
</span><a href="Web.Scotty.Internal.Types.html#ContentFile"><span class="hs-identifier hs-var">ContentFile</span></a></span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span id="local-6989586621679119868"><span class="annot"><a href="Web.Scotty.Action.html#rawResponse"><span class="hs-identifier hs-type">rawResponse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119868"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Response</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119868"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-457"></span><span id="rawResponse"><span class="annot"><span class="annottext">rawResponse :: forall (m :: * -&gt; *). MonadIO m =&gt; Response -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#rawResponse"><span class="hs-identifier hs-var hs-var">rawResponse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ScottyResponse -&gt; ScottyResponse) -&gt; ActionT m ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
(ScottyResponse -&gt; ScottyResponse) -&gt; ActionT m ()
</span><a href="Web.Scotty.Internal.Types.html#modifyResponse"><span class="hs-identifier hs-var">modifyResponse</span></a></span><span> </span><span class="annot"><span class="annottext">((ScottyResponse -&gt; ScottyResponse) -&gt; ActionT m ())
-&gt; (Response -&gt; ScottyResponse -&gt; ScottyResponse)
-&gt; Response
-&gt; ActionT m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; ScottyResponse -&gt; ScottyResponse
</span><a href="Web.Scotty.Internal.Types.html#setContent"><span class="hs-identifier hs-var">setContent</span></a></span><span> </span><span class="annot"><span class="annottext">(Content -&gt; ScottyResponse -&gt; ScottyResponse)
-&gt; (Response -&gt; Content)
-&gt; Response
-&gt; ScottyResponse
-&gt; ScottyResponse
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Response -&gt; Content
</span><a href="Web.Scotty.Internal.Types.html#ContentResponse"><span class="hs-identifier hs-var">ContentResponse</span></a></span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="hs-comment">-- | Set the body of the response to the JSON encoding of the given value. Also sets \&quot;Content-Type\&quot;</span><span>
</span><span id="line-460"></span><span class="hs-comment">-- header to \&quot;application/json; charset=utf-8\&quot; if it has not already been set.</span><span>
</span><span id="line-461"></span><span id="local-6989586621679119870"><span id="local-6989586621679119872"><span class="annot"><a href="Web.Scotty.Action.html#json"><span class="hs-identifier hs-type">json</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679119870"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119872"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119870"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119872"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-462"></span><span id="json"><span class="annot"><span class="annottext">json :: forall a (m :: * -&gt; *). (ToJSON a, MonadIO m) =&gt; a -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#json"><span class="hs-identifier hs-var hs-var">json</span></a></span></span><span> </span><span id="local-6989586621679120556"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120556"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-463"></span><span>    </span><span class="annot"><span class="annottext">(CI ByteString -&gt; ByteString -&gt; RequestHeaders -&gt; RequestHeaders)
-&gt; Text -&gt; Text -&gt; ActionT m ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
(CI ByteString -&gt; ByteString -&gt; RequestHeaders -&gt; RequestHeaders)
-&gt; Text -&gt; Text -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#changeHeader"><span class="hs-identifier hs-var">changeHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString -&gt; RequestHeaders -&gt; RequestHeaders
forall a b. Eq a =&gt; a -&gt; b -&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="Web.Scotty.Util.html#addIfNotPresent"><span class="hs-identifier hs-var">addIfNotPresent</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Content-Type&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;application/json; charset=utf-8&quot;</span></span><span>
</span><span id="line-464"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; ActionT m ()
forall (m :: * -&gt; *). MonadIO m =&gt; ByteString -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#raw"><span class="hs-identifier hs-var">raw</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ActionT m ()) -&gt; ByteString -&gt; ActionT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">A.encode</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120556"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span class="hs-comment">-- | Set the body of the response to a Source. Doesn't set the</span><span>
</span><span id="line-467"></span><span class="hs-comment">-- \&quot;Content-Type\&quot; header, so you probably want to do that on your</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- own with 'setHeader'.</span><span>
</span><span id="line-469"></span><span id="local-6989586621679119876"><span class="annot"><a href="Web.Scotty.Action.html#stream"><span class="hs-identifier hs-type">stream</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119876"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StreamingBody</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119876"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-470"></span><span id="stream"><span class="annot"><span class="annottext">stream :: forall (m :: * -&gt; *). MonadIO m =&gt; StreamingBody -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#stream"><span class="hs-identifier hs-var hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ScottyResponse -&gt; ScottyResponse) -&gt; ActionT m ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
(ScottyResponse -&gt; ScottyResponse) -&gt; ActionT m ()
</span><a href="Web.Scotty.Internal.Types.html#modifyResponse"><span class="hs-identifier hs-var">modifyResponse</span></a></span><span> </span><span class="annot"><span class="annottext">((ScottyResponse -&gt; ScottyResponse) -&gt; ActionT m ())
-&gt; (StreamingBody -&gt; ScottyResponse -&gt; ScottyResponse)
-&gt; StreamingBody
-&gt; ActionT m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; ScottyResponse -&gt; ScottyResponse
</span><a href="Web.Scotty.Internal.Types.html#setContent"><span class="hs-identifier hs-var">setContent</span></a></span><span> </span><span class="annot"><span class="annottext">(Content -&gt; ScottyResponse -&gt; ScottyResponse)
-&gt; (StreamingBody -&gt; Content)
-&gt; StreamingBody
-&gt; ScottyResponse
-&gt; ScottyResponse
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StreamingBody -&gt; Content
</span><a href="Web.Scotty.Internal.Types.html#ContentStream"><span class="hs-identifier hs-var">ContentStream</span></a></span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span class="hs-comment">-- | Set the body of the response to the given 'BL.ByteString' value. Doesn't set the</span><span>
</span><span id="line-473"></span><span class="hs-comment">-- \&quot;Content-Type\&quot; header, so you probably want to do that on your</span><span>
</span><span id="line-474"></span><span class="hs-comment">-- own with 'setHeader'.</span><span>
</span><span id="line-475"></span><span id="local-6989586621679119863"><span class="annot"><a href="Web.Scotty.Action.html#raw"><span class="hs-identifier hs-type">raw</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119863"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119863"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-476"></span><span id="raw"><span class="annot"><span class="annottext">raw :: forall (m :: * -&gt; *). MonadIO m =&gt; ByteString -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#raw"><span class="hs-identifier hs-var hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ScottyResponse -&gt; ScottyResponse) -&gt; ActionT m ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
(ScottyResponse -&gt; ScottyResponse) -&gt; ActionT m ()
</span><a href="Web.Scotty.Internal.Types.html#modifyResponse"><span class="hs-identifier hs-var">modifyResponse</span></a></span><span> </span><span class="annot"><span class="annottext">((ScottyResponse -&gt; ScottyResponse) -&gt; ActionT m ())
-&gt; (ByteString -&gt; ScottyResponse -&gt; ScottyResponse)
-&gt; ByteString
-&gt; ActionT m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; ScottyResponse -&gt; ScottyResponse
</span><a href="Web.Scotty.Internal.Types.html#setContent"><span class="hs-identifier hs-var">setContent</span></a></span><span> </span><span class="annot"><span class="annottext">(Content -&gt; ScottyResponse -&gt; ScottyResponse)
-&gt; (ByteString -&gt; Content)
-&gt; ByteString
-&gt; ScottyResponse
-&gt; ScottyResponse
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Content
</span><a href="Web.Scotty.Internal.Types.html#ContentBuilder"><span class="hs-identifier hs-var">ContentBuilder</span></a></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Content)
-&gt; (ByteString -&gt; Builder) -&gt; ByteString -&gt; Content
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">fromLazyByteString</span></span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span class="hs-comment">-- | Nest a whole WAI application inside a Scotty handler.</span><span>
</span><span id="line-479"></span><span class="hs-comment">-- See Web.Scotty for further documentation</span><span>
</span><span id="line-480"></span><span id="local-6989586621679119881"><span class="annot"><a href="Web.Scotty.Action.html#nested"><span class="hs-identifier hs-type">nested</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679119881"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Network.Wai.Application</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier hs-type">ActionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119881"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-481"></span><span id="nested"><span class="annot"><span class="annottext">nested :: forall (m :: * -&gt; *). MonadIO m =&gt; Application -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#nested"><span class="hs-identifier hs-var hs-var">nested</span></a></span></span><span> </span><span id="local-6989586621679120577"><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679120577"><span class="hs-identifier hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-482"></span><span>  </span><span class="hs-comment">-- Is MVar really the best choice here? Not sure.</span><span>
</span><span id="line-483"></span><span>  </span><span id="local-6989586621679120578"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679120578"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ActionT m Request
forall (m :: * -&gt; *). Monad m =&gt; ActionT m Request
</span><a href="Web.Scotty.Action.html#request"><span class="hs-identifier hs-var">request</span></a></span><span>
</span><span id="line-484"></span><span>  </span><span id="local-6989586621679120579"><span class="annot"><span class="annottext">MVar Response
</span><a href="#local-6989586621679120579"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (MVar Response) -&gt; ActionT m (MVar Response)
forall a. IO a -&gt; ActionT m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (MVar Response) -&gt; ActionT m (MVar Response))
-&gt; IO (MVar Response) -&gt; ActionT m (MVar Response)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO (MVar Response)
forall a. IO (MVar a)
</span><span class="hs-identifier hs-var">newEmptyMVar</span></span><span>
</span><span id="line-485"></span><span>  </span><span class="annot"><span class="annottext">ResponseReceived
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ResponseReceived -&gt; ActionT m ResponseReceived
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#liftAndCatchIO"><span class="hs-identifier hs-var">liftAndCatchIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ResponseReceived -&gt; ActionT m ResponseReceived)
-&gt; IO ResponseReceived -&gt; ActionT m ResponseReceived
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679120577"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679120578"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679120581"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679120581"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MVar Response -&gt; Response -&gt; IO ()
forall a. MVar a -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">putMVar</span></span><span> </span><span class="annot"><span class="annottext">MVar Response
</span><a href="#local-6989586621679120579"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679120581"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO ResponseReceived -&gt; IO ResponseReceived
forall a b. IO a -&gt; IO b -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ResponseReceived -&gt; IO ResponseReceived
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ResponseReceived
</span><span class="hs-identifier hs-var">ResponseReceived</span></span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span>  </span><span id="local-6989586621679120584"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679120584"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Response -&gt; ActionT m Response
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; ActionT m a
</span><a href="Web.Scotty.Action.html#liftAndCatchIO"><span class="hs-identifier hs-var">liftAndCatchIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Response -&gt; ActionT m Response)
-&gt; IO Response -&gt; ActionT m Response
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MVar Response -&gt; IO Response
forall a. MVar a -&gt; IO a
</span><span class="hs-identifier hs-var">readMVar</span></span><span> </span><span class="annot"><span class="annottext">MVar Response
</span><a href="#local-6989586621679120579"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-487"></span><span>  </span><span class="annot"><span class="annottext">Response -&gt; ActionT m ()
forall (m :: * -&gt; *). MonadIO m =&gt; Response -&gt; ActionT m ()
</span><a href="Web.Scotty.Action.html#rawResponse"><span class="hs-identifier hs-var">rawResponse</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679120584"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-488"></span></pre></body></html>